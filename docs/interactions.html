<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Interactions | Learning Statistical Models Through Simulation in R</title>
  <meta name="description" content="Textbook on statistical models for social scientists." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Interactions | Learning Statistical Models Through Simulation in R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Textbook on statistical models for social scientists." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Interactions | Learning Statistical Models Through Simulation in R" />
  
  <meta name="twitter:description" content="Textbook on statistical models for social scientists." />
  

<meta name="author" content="Dale J. Barr" />


<meta name="date" content="2021-05-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="multiple-regression.html"/>
<link rel="next" href="introducing-linear-mixed-effects-models.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="include/psyteachr.css" type="text/css" />
<link rel="stylesheet" href="include/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Statistical Models</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Overview</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-cite-this-book"><i class="fa fa-check"></i>How to cite this book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#found-an-issue"><i class="fa fa-check"></i>Found an issue?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#information-for-educators"><i class="fa fa-check"></i>Information for educators</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#goal-of-this-course"><i class="fa fa-check"></i><b>1.1</b> Goal of this course</a><ul>
<li class="chapter" data-level="1.1.1" data-path="introduction.html"><a href="introduction.html#flexibility"><i class="fa fa-check"></i><b>1.1.1</b> Flexibility</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#generalizability"><i class="fa fa-check"></i><b>1.2</b> Generalizability</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#reproduciblity-and-transparency"><i class="fa fa-check"></i><b>1.3</b> Reproduciblity and Transparency</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#a-simulation-based-approach"><i class="fa fa-check"></i><b>1.4</b> A simulation-based approach</a></li>
<li class="chapter" data-level="1.5" data-path="introduction.html"><a href="introduction.html#what-you-will-learn"><i class="fa fa-check"></i><b>1.5</b> What you will learn</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="understanding-correlation-and-regression-through-bivariate-simulation.html"><a href="understanding-correlation-and-regression-through-bivariate-simulation.html"><i class="fa fa-check"></i><b>2</b> Understanding correlation and regression through bivariate simulation</a><ul>
<li class="chapter" data-level="2.1" data-path="understanding-correlation-and-regression-through-bivariate-simulation.html"><a href="understanding-correlation-and-regression-through-bivariate-simulation.html#correlation-matrices"><i class="fa fa-check"></i><b>2.1</b> Correlation matrices</a></li>
<li class="chapter" data-level="2.2" data-path="understanding-correlation-and-regression-through-bivariate-simulation.html"><a href="understanding-correlation-and-regression-through-bivariate-simulation.html#simulating-bivariate-data"><i class="fa fa-check"></i><b>2.2</b> Simulating bivariate data</a><ul>
<li class="chapter" data-level="2.2.1" data-path="understanding-correlation-and-regression-through-bivariate-simulation.html"><a href="understanding-correlation-and-regression-through-bivariate-simulation.html#bivariate-app"><i class="fa fa-check"></i><b>2.2.1</b> Bivariate app</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="understanding-correlation-and-regression-through-bivariate-simulation.html"><a href="understanding-correlation-and-regression-through-bivariate-simulation.html#relationship-between-correlation-and-regression"><i class="fa fa-check"></i><b>2.3</b> Relationship between correlation and regression</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="multiple-regression.html"><a href="multiple-regression.html"><i class="fa fa-check"></i><b>3</b> Multiple regression</a><ul>
<li class="chapter" data-level="3.1" data-path="multiple-regression.html"><a href="multiple-regression.html#an-example-how-to-get-a-good-grade-in-statistics"><i class="fa fa-check"></i><b>3.1</b> An example: How to get a good grade in statistics</a><ul>
<li class="chapter" data-level="3.1.1" data-path="multiple-regression.html"><a href="multiple-regression.html#data-import-and-visualization"><i class="fa fa-check"></i><b>3.1.1</b> Data import and visualization</a></li>
<li class="chapter" data-level="3.1.2" data-path="multiple-regression.html"><a href="multiple-regression.html#estimation-and-interpretation"><i class="fa fa-check"></i><b>3.1.2</b> Estimation and interpretation</a></li>
<li class="chapter" data-level="3.1.3" data-path="multiple-regression.html"><a href="multiple-regression.html#predictions-from-the-linear-model-using-predict"><i class="fa fa-check"></i><b>3.1.3</b> Predictions from the linear model using <code>predict()</code></a></li>
<li class="chapter" data-level="3.1.4" data-path="multiple-regression.html"><a href="multiple-regression.html#visualizing-partial-effects"><i class="fa fa-check"></i><b>3.1.4</b> Visualizing partial effects</a></li>
<li class="chapter" data-level="3.1.5" data-path="multiple-regression.html"><a href="multiple-regression.html#standardizing-coefficients"><i class="fa fa-check"></i><b>3.1.5</b> Standardizing coefficients</a></li>
<li class="chapter" data-level="3.1.6" data-path="multiple-regression.html"><a href="multiple-regression.html#model-comparison"><i class="fa fa-check"></i><b>3.1.6</b> Model comparison</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="multiple-regression.html"><a href="multiple-regression.html#dealing-with-categorical-predictors"><i class="fa fa-check"></i><b>3.2</b> Dealing with categorical predictors</a><ul>
<li class="chapter" data-level="3.2.1" data-path="multiple-regression.html"><a href="multiple-regression.html#dummy-coding"><i class="fa fa-check"></i><b>3.2.1</b> Dummy coding</a></li>
<li class="chapter" data-level="3.2.2" data-path="multiple-regression.html"><a href="multiple-regression.html#dummy-coding-when-k-2"><i class="fa fa-check"></i><b>3.2.2</b> Dummy coding when <span class="math inline">\(k &gt; 2\)</span></a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="multiple-regression.html"><a href="multiple-regression.html#equivalence-between-multiple-regression-and-one-way-anova"><i class="fa fa-check"></i><b>3.3</b> Equivalence between multiple regression and one-way ANOVA</a></li>
<li class="chapter" data-level="3.4" data-path="multiple-regression.html"><a href="multiple-regression.html#solution-to-partial-effect-plot"><i class="fa fa-check"></i><b>3.4</b> Solution to partial effect plot</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="interactions.html"><a href="interactions.html"><i class="fa fa-check"></i><b>4</b> Interactions</a><ul>
<li class="chapter" data-level="4.1" data-path="interactions.html"><a href="interactions.html#learning-objectives"><i class="fa fa-check"></i><b>4.1</b> Learning objectives</a></li>
<li class="chapter" data-level="4.2" data-path="interactions.html"><a href="interactions.html#interactions-1"><i class="fa fa-check"></i><b>4.2</b> Interactions</a></li>
<li class="chapter" data-level="4.3" data-path="interactions.html"><a href="interactions.html#cont-by-cat"><i class="fa fa-check"></i><b>4.3</b> Continuous-by-Categorical Interactions</a></li>
<li class="chapter" data-level="4.4" data-path="interactions.html"><a href="interactions.html#categorical-by-categorical-interactions"><i class="fa fa-check"></i><b>4.4</b> Categorical-by-Categorical Interactions</a><ul>
<li class="chapter" data-level="4.4.1" data-path="interactions.html"><a href="interactions.html#effects-of-cognitive-therapy-and-drug-therapy-on-mood"><i class="fa fa-check"></i><b>4.4.1</b> Effects of cognitive therapy and drug therapy on mood</a></li>
<li class="chapter" data-level="4.4.2" data-path="interactions.html"><a href="interactions.html#effects-in-a-factorial-design"><i class="fa fa-check"></i><b>4.4.2</b> Effects in a factorial design</a></li>
<li class="chapter" data-level="4.4.3" data-path="interactions.html"><a href="interactions.html#higher-order-designs"><i class="fa fa-check"></i><b>4.4.3</b> Higher-order designs</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="interactions.html"><a href="interactions.html#the-glm-for-a-factorial-design"><i class="fa fa-check"></i><b>4.5</b> The GLM for a factorial design</a><ul>
<li class="chapter" data-level="4.5.1" data-path="interactions.html"><a href="interactions.html#estimation-equations"><i class="fa fa-check"></i><b>4.5.1</b> Estimation equations</a></li>
<li class="chapter" data-level="4.5.2" data-path="interactions.html"><a href="interactions.html#factorial-app"><i class="fa fa-check"></i><b>4.5.2</b> Factorial App</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="interactions.html"><a href="interactions.html#code-your-own-categorical-predictors-in-factorial-designs"><i class="fa fa-check"></i><b>4.6</b> Code your own categorical predictors in factorial designs</a></li>
<li class="chapter" data-level="4.7" data-path="interactions.html"><a href="interactions.html#coding-schemes-for-categorical-variables"><i class="fa fa-check"></i><b>4.7</b> Coding schemes for categorical variables</a><ul>
<li class="chapter" data-level="4.7.1" data-path="interactions.html"><a href="interactions.html#simple-versus-main-effects"><i class="fa fa-check"></i><b>4.7.1</b> Simple versus main effects</a></li>
<li class="chapter" data-level="4.7.2" data-path="interactions.html"><a href="interactions.html#the-key-coding-schemes"><i class="fa fa-check"></i><b>4.7.2</b> The key coding schemes</a></li>
<li class="chapter" data-level="4.7.3" data-path="interactions.html"><a href="interactions.html#what-about-factors-with-more-than-two-levels"><i class="fa fa-check"></i><b>4.7.3</b> What about factors with more than two levels?</a></li>
<li class="chapter" data-level="4.7.4" data-path="interactions.html"><a href="interactions.html#example-three-level-factor"><i class="fa fa-check"></i><b>4.7.4</b> Example: Three-level factor</a></li>
<li class="chapter" data-level="4.7.5" data-path="interactions.html"><a href="interactions.html#how-to-create-your-own-numeric-predictors"><i class="fa fa-check"></i><b>4.7.5</b> How to create your own numeric predictors</a></li>
<li class="chapter" data-level="4.7.6" data-path="interactions.html"><a href="interactions.html#conclusion"><i class="fa fa-check"></i><b>4.7.6</b> Conclusion</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="introducing-linear-mixed-effects-models.html"><a href="introducing-linear-mixed-effects-models.html"><i class="fa fa-check"></i><b>5</b> Introducing Linear Mixed-Effects Models</a><ul>
<li class="chapter" data-level="5.1" data-path="interactions.html"><a href="interactions.html#learning-objectives"><i class="fa fa-check"></i><b>5.1</b> Learning objectives</a></li>
<li class="chapter" data-level="5.2" data-path="introducing-linear-mixed-effects-models.html"><a href="introducing-linear-mixed-effects-models.html#modeling-multi-level-data"><i class="fa fa-check"></i><b>5.2</b> Modeling multi-level data</a></li>
<li class="chapter" data-level="5.3" data-path="introducing-linear-mixed-effects-models.html"><a href="introducing-linear-mixed-effects-models.html#how-to-model-these-data"><i class="fa fa-check"></i><b>5.3</b> How to model these data?</a><ul>
<li class="chapter" data-level="5.3.1" data-path="introducing-linear-mixed-effects-models.html"><a href="introducing-linear-mixed-effects-models.html#complete-pooling-one-size-fits-all"><i class="fa fa-check"></i><b>5.3.1</b> Complete pooling: One size fits all</a></li>
<li class="chapter" data-level="5.3.2" data-path="introducing-linear-mixed-effects-models.html"><a href="introducing-linear-mixed-effects-models.html#no-pooling"><i class="fa fa-check"></i><b>5.3.2</b> No pooling</a></li>
<li class="chapter" data-level="5.3.3" data-path="introducing-linear-mixed-effects-models.html"><a href="introducing-linear-mixed-effects-models.html#partial-pooling-using-mixed-effects-models"><i class="fa fa-check"></i><b>5.3.3</b> Partial pooling using mixed-effects models</a></li>
<li class="chapter" data-level="5.3.4" data-path="introducing-linear-mixed-effects-models.html"><a href="introducing-linear-mixed-effects-models.html#the-variance-covariance-matrix"><i class="fa fa-check"></i><b>5.3.4</b> The variance-covariance matrix</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="introducing-linear-mixed-effects-models.html"><a href="introducing-linear-mixed-effects-models.html#estimating-the-model-parameters"><i class="fa fa-check"></i><b>5.4</b> Estimating the model parameters</a></li>
<li class="chapter" data-level="5.5" data-path="introducing-linear-mixed-effects-models.html"><a href="introducing-linear-mixed-effects-models.html#interpreting-lmer-output-and-extracting-estimates"><i class="fa fa-check"></i><b>5.5</b> Interpreting <code>lmer()</code> output and extracting estimates</a><ul>
<li class="chapter" data-level="5.5.1" data-path="introducing-linear-mixed-effects-models.html"><a href="introducing-linear-mixed-effects-models.html#fixed-effects"><i class="fa fa-check"></i><b>5.5.1</b> Fixed effects</a></li>
<li class="chapter" data-level="5.5.2" data-path="introducing-linear-mixed-effects-models.html"><a href="introducing-linear-mixed-effects-models.html#random-effects"><i class="fa fa-check"></i><b>5.5.2</b> Random effects</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="introducing-linear-mixed-effects-models.html"><a href="introducing-linear-mixed-effects-models.html#multi-level-app"><i class="fa fa-check"></i><b>5.6</b> Multi-level app</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="linear-mixed-effects-models-with-one-random-factor.html"><a href="linear-mixed-effects-models-with-one-random-factor.html"><i class="fa fa-check"></i><b>6</b> Linear mixed-effects models with one random factor</a><ul>
<li class="chapter" data-level="6.1" data-path="interactions.html"><a href="interactions.html#learning-objectives"><i class="fa fa-check"></i><b>6.1</b> Learning objectives</a></li>
<li class="chapter" data-level="6.2" data-path="linear-mixed-effects-models-with-one-random-factor.html"><a href="linear-mixed-effects-models-with-one-random-factor.html#when-and-why-would-you-want-to-replace-conventional-analyses-with-linear-mixed-effects-modeling"><i class="fa fa-check"></i><b>6.2</b> When, and why, would you want to replace conventional analyses with linear mixed-effects modeling?</a></li>
<li class="chapter" data-level="6.3" data-path="linear-mixed-effects-models-with-one-random-factor.html"><a href="linear-mixed-effects-models-with-one-random-factor.html#example-independent-samples-t-test-on-multi-level-data"><i class="fa fa-check"></i><b>6.3</b> Example: Independent-samples <span class="math inline">\(t\)</span>-test on multi-level data</a><ul>
<li class="chapter" data-level="6.3.1" data-path="linear-mixed-effects-models-with-one-random-factor.html"><a href="linear-mixed-effects-models-with-one-random-factor.html#when-is-a-random-intercepts-model-appropriate"><i class="fa fa-check"></i><b>6.3.1</b> When is a random-intercepts model appropriate?</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="linear-mixed-effects-models-with-one-random-factor.html"><a href="linear-mixed-effects-models-with-one-random-factor.html#expressing-the-study-design-and-performing-tests-in-regression"><i class="fa fa-check"></i><b>6.4</b> Expressing the study design and performing tests in regression</a><ul>
<li class="chapter" data-level="6.4.1" data-path="linear-mixed-effects-models-with-one-random-factor.html"><a href="linear-mixed-effects-models-with-one-random-factor.html#factors-with-more-than-two-levels"><i class="fa fa-check"></i><b>6.4.1</b> Factors with more than two levels</a></li>
<li class="chapter" data-level="6.4.2" data-path="linear-mixed-effects-models-with-one-random-factor.html"><a href="linear-mixed-effects-models-with-one-random-factor.html#multiparameter-tests"><i class="fa fa-check"></i><b>6.4.2</b> Multiparameter tests</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="linear-mixed-effects-models-with-crossed-random-factors.html"><a href="linear-mixed-effects-models-with-crossed-random-factors.html"><i class="fa fa-check"></i><b>7</b> Linear mixed-effects models with crossed random factors</a><ul>
<li class="chapter" data-level="7.1" data-path="interactions.html"><a href="interactions.html#learning-objectives"><i class="fa fa-check"></i><b>7.1</b> Learning objectives</a></li>
<li class="chapter" data-level="7.2" data-path="linear-mixed-effects-models-with-crossed-random-factors.html"><a href="linear-mixed-effects-models-with-crossed-random-factors.html#web-app"><i class="fa fa-check"></i><b>7.2</b> Web app</a></li>
<li class="chapter" data-level="7.3" data-path="linear-mixed-effects-models-with-crossed-random-factors.html"><a href="linear-mixed-effects-models-with-crossed-random-factors.html#generalizing-over-encounters-between-subjects-and-stimuli"><i class="fa fa-check"></i><b>7.3</b> Generalizing over encounters between subjects and stimuli</a></li>
<li class="chapter" data-level="7.4" data-path="linear-mixed-effects-models-with-crossed-random-factors.html"><a href="linear-mixed-effects-models-with-crossed-random-factors.html#lme4-syntax-for-crossed-random-factors"><i class="fa fa-check"></i><b>7.4</b> lme4 syntax for crossed random factors</a></li>
<li class="chapter" data-level="7.5" data-path="linear-mixed-effects-models-with-crossed-random-factors.html"><a href="linear-mixed-effects-models-with-crossed-random-factors.html#specifying-random-effects"><i class="fa fa-check"></i><b>7.5</b> Specifying random effects</a><ul>
<li class="chapter" data-level="7.5.1" data-path="linear-mixed-effects-models-with-crossed-random-factors.html"><a href="linear-mixed-effects-models-with-crossed-random-factors.html#rules-for-choosing-random-effects-for-categorical-factors"><i class="fa fa-check"></i><b>7.5.1</b> Rules for choosing random effects for categorical factors</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="linear-mixed-effects-models-with-crossed-random-factors.html"><a href="linear-mixed-effects-models-with-crossed-random-factors.html#simulating-data-with-crossed-random-factors"><i class="fa fa-check"></i><b>7.6</b> Simulating data with crossed random factors</a><ul>
<li class="chapter" data-level="7.6.1" data-path="linear-mixed-effects-models-with-crossed-random-factors.html"><a href="linear-mixed-effects-models-with-crossed-random-factors.html#set-up-the-environment-and-define-the-parameters-for-the-dgp"><i class="fa fa-check"></i><b>7.6.1</b> Set up the environment and define the parameters for the DGP</a></li>
<li class="chapter" data-level="7.6.2" data-path="linear-mixed-effects-models-with-crossed-random-factors.html"><a href="linear-mixed-effects-models-with-crossed-random-factors.html#generate-a-sample-of-stimuli"><i class="fa fa-check"></i><b>7.6.2</b> Generate a sample of stimuli</a></li>
<li class="chapter" data-level="7.6.3" data-path="linear-mixed-effects-models-with-crossed-random-factors.html"><a href="linear-mixed-effects-models-with-crossed-random-factors.html#generate-a-sample-of-subjects"><i class="fa fa-check"></i><b>7.6.3</b> Generate a sample of subjects</a></li>
<li class="chapter" data-level="7.6.4" data-path="linear-mixed-effects-models-with-crossed-random-factors.html"><a href="linear-mixed-effects-models-with-crossed-random-factors.html#generate-a-sample-of-encounters-trials"><i class="fa fa-check"></i><b>7.6.4</b> Generate a sample of encounters (trials)</a></li>
<li class="chapter" data-level="7.6.5" data-path="linear-mixed-effects-models-with-crossed-random-factors.html"><a href="linear-mixed-effects-models-with-crossed-random-factors.html#join-subjects-items-and-trials"><i class="fa fa-check"></i><b>7.6.5</b> Join <code>subjects</code>, <code>items</code>, and <code>trials</code></a></li>
<li class="chapter" data-level="7.6.6" data-path="linear-mixed-effects-models-with-crossed-random-factors.html"><a href="linear-mixed-effects-models-with-crossed-random-factors.html#create-the-response-variable"><i class="fa fa-check"></i><b>7.6.6</b> Create the response variable</a></li>
<li class="chapter" data-level="7.6.7" data-path="linear-mixed-effects-models-with-crossed-random-factors.html"><a href="linear-mixed-effects-models-with-crossed-random-factors.html#fitting-the-model"><i class="fa fa-check"></i><b>7.6.7</b> Fitting the model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="generalized-linear-mixed-effects-models.html"><a href="generalized-linear-mixed-effects-models.html"><i class="fa fa-check"></i><b>8</b> Generalized linear mixed-effects models</a><ul>
<li class="chapter" data-level="8.1" data-path="interactions.html"><a href="interactions.html#learning-objectives"><i class="fa fa-check"></i><b>8.1</b> Learning objectives</a></li>
<li class="chapter" data-level="8.2" data-path="generalized-linear-mixed-effects-models.html"><a href="generalized-linear-mixed-effects-models.html#discrete-versus-continuous-data"><i class="fa fa-check"></i><b>8.2</b> Discrete versus continuous data</a><ul>
<li class="chapter" data-level="8.2.1" data-path="generalized-linear-mixed-effects-models.html"><a href="generalized-linear-mixed-effects-models.html#why-not-model-discrete-data-as-continuous"><i class="fa fa-check"></i><b>8.2.1</b> Why not model discrete data as continuous?</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="generalized-linear-mixed-effects-models.html"><a href="generalized-linear-mixed-effects-models.html#generalized-linear-models"><i class="fa fa-check"></i><b>8.3</b> Generalized Linear Models</a></li>
<li class="chapter" data-level="8.4" data-path="generalized-linear-mixed-effects-models.html"><a href="generalized-linear-mixed-effects-models.html#logistic-regression"><i class="fa fa-check"></i><b>8.4</b> Logistic regression</a><ul>
<li class="chapter" data-level="8.4.1" data-path="generalized-linear-mixed-effects-models.html"><a href="generalized-linear-mixed-effects-models.html#terminology"><i class="fa fa-check"></i><b>8.4.1</b> Terminology</a></li>
<li class="chapter" data-level="8.4.2" data-path="generalized-linear-mixed-effects-models.html"><a href="generalized-linear-mixed-effects-models.html#properties-of-log-odds"><i class="fa fa-check"></i><b>8.4.2</b> Properties of log odds</a></li>
<li class="chapter" data-level="8.4.3" data-path="generalized-linear-mixed-effects-models.html"><a href="generalized-linear-mixed-effects-models.html#link-and-variance-functions"><i class="fa fa-check"></i><b>8.4.3</b> Link and variance functions</a></li>
<li class="chapter" data-level="8.4.4" data-path="generalized-linear-mixed-effects-models.html"><a href="generalized-linear-mixed-effects-models.html#estimating-logistic-regression-models-in-r"><i class="fa fa-check"></i><b>8.4.4</b> Estimating logistic regression models in R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="modeling-ordinal-data.html"><a href="modeling-ordinal-data.html"><i class="fa fa-check"></i><b>9</b> Modeling Ordinal Data</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="symbols.html"><a href="symbols.html"><i class="fa fa-check"></i><b>A</b> Symbols</a><ul>
<li class="chapter" data-level="A.1" data-path="symbols.html"><a href="symbols.html#general-notes"><i class="fa fa-check"></i><b>A.1</b> General notes</a></li>
<li class="chapter" data-level="A.2" data-path="symbols.html"><a href="symbols.html#table-of-symbols"><i class="fa fa-check"></i><b>A.2</b> Table of symbols</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="bibliography.html"><a href="bibliography.html"><i class="fa fa-check"></i><b>B</b> Bibliography</a></li>
<li class="divider"></li>
<li><a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/" 
    target="blank"><img alt="Creative Commons License" 
    style="border-width:0" 
    src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a></li>
<li><a href="https://psyteachr.github.io/books" target="blank">PsyTeachR Books</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Learning Statistical Models Through Simulation in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="interactions" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> Interactions</h1>
<div id="learning-objectives" class="section level2">
<h2><span class="header-section-number">4.1</span> Learning objectives</h2>
<ul>
<li>model and interpret continuous-by-categorical interactions</li>
<li>model and interpret categorical-by-categorical interactions in factorial designs</li>
<li>estimate and test effects in factorial designs using ANOVA or regression</li>
</ul>
<!-- understand a common fallacy regarding interactions -->
</div>
<div id="interactions-1" class="section level2">
<h2><span class="header-section-number">4.2</span> Interactions</h2>
<p>Up to now, we’ve been focusing on estimating and interpreting the effect of a variable or linear combination of predictor variables on a response variable. However, there are often situations where the effect of one predictor on the response depends on the value of another predictor variable. We can actually estimate and interpret this dependency as well, by including an <strong>interaction</strong> term in our model.</p>
</div>
<div id="cont-by-cat" class="section level2">
<h2><span class="header-section-number">4.3</span> Continuous-by-Categorical Interactions</h2>
<p>One common example of this is when you are interested in whether a linear relationship between a continous predictor and a continuous response is different for two groups.</p>
<p>Let’s consider a simple fictional example. Say you are interested in the effects of sonic distraction on cognitive performance. Each participant in your study is randomly assigned to receive a particular amount of sonic distraction while they perform a simple reaction time task (respond as quickly as possible to a flashing light). You have a technique that allows you to automatically generate different levels of background noise (e.g., frequency and amplitude of city sounds, such as sirens, jackhammers, people yelling, glass breaking, etc.). Each participant performs the task for a randomly chosen level of distraction (0 to 100). Your hypothesis is that urban living makes people’s task performance more immune to sonic distraction. You want to compare the relationship between distraction and performance for city dwellers to the relationship for people from quieter rural environments.</p>
<p>You have three variables:</p>
<ul>
<li>A continuous response variable, <code>mean_RT</code>, with higher levels reflecting slower RTs;</li>
<li>A continuous predictor variable, level of sonic distraction (<code>dist_level</code>), with higher levels indicating more distraction;</li>
<li>A factor with two levels, <code>group</code> (urban vs. rural).</li>
</ul>
<p>Let’s start by simulating some data for the urban group. Let’s assume that with zero distraction (silence), the average RT is about 450 milliseconds, and that with each unit increase on the distraction scale, RT increases about 2 ms. This gives us the following linear model:</p>
<p><span class="math display">\[Y_i = 450 + 2 X_i + e_i\]</span></p>
<p>where <span class="math inline">\(X_i\)</span> is the amount of sonic distraction.</p>
<p>Let’s simulate data for 100 participants as below with <span class="math inline">\(\sigma = 80\)</span>, setting the seed before we begin.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" title="1"><span class="kw">library</span>(<span class="st">&quot;tidyverse&quot;</span>)</a>
<a class="sourceLine" id="cb88-2" title="2"><span class="kw">set.seed</span>(<span class="dv">1031</span>)</a>
<a class="sourceLine" id="cb88-3" title="3"></a>
<a class="sourceLine" id="cb88-4" title="4">n_subj &lt;-<span class="st"> </span>100L  <span class="co"># simulate data for 100 subjects</span></a>
<a class="sourceLine" id="cb88-5" title="5">b0_urban &lt;-<span class="st"> </span><span class="dv">450</span> <span class="co"># y-intercept</span></a>
<a class="sourceLine" id="cb88-6" title="6">b1_urban &lt;-<span class="st"> </span><span class="dv">2</span>   <span class="co"># slope</span></a>
<a class="sourceLine" id="cb88-7" title="7"></a>
<a class="sourceLine" id="cb88-8" title="8"><span class="co"># decomposition table</span></a>
<a class="sourceLine" id="cb88-9" title="9">urban &lt;-<span class="st"> </span><span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb88-10" title="10">  <span class="dt">subj_id =</span> <span class="dv">1</span><span class="op">:</span>n_subj,</a>
<a class="sourceLine" id="cb88-11" title="11">  <span class="dt">group =</span> <span class="st">&quot;urban&quot;</span>,</a>
<a class="sourceLine" id="cb88-12" title="12">  <span class="dt">b0 =</span> <span class="dv">450</span>,</a>
<a class="sourceLine" id="cb88-13" title="13">  <span class="dt">b1 =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb88-14" title="14">  <span class="dt">dist_level =</span> <span class="kw">sample</span>(<span class="dv">0</span><span class="op">:</span>n_subj, n_subj, <span class="dt">replace =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb88-15" title="15">  <span class="dt">err =</span> <span class="kw">rnorm</span>(n_subj, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">80</span>),</a>
<a class="sourceLine" id="cb88-16" title="16">  <span class="dt">simple_rt =</span> b0 <span class="op">+</span><span class="st"> </span>b1 <span class="op">*</span><span class="st"> </span>dist_level <span class="op">+</span><span class="st"> </span>err)</a>
<a class="sourceLine" id="cb88-17" title="17"></a>
<a class="sourceLine" id="cb88-18" title="18">urban</a></code></pre></div>
<pre><code>## # A tibble: 100 x 7
##    subj_id group    b0    b1 dist_level     err simple_rt
##      &lt;int&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;      &lt;int&gt;   &lt;dbl&gt;     &lt;dbl&gt;
##  1       1 urban   450     2         59  -36.1       532.
##  2       2 urban   450     2         45  128.        668.
##  3       3 urban   450     2         55   23.5       584.
##  4       4 urban   450     2          8    1.04      467.
##  5       5 urban   450     2         47   48.7       593.
##  6       6 urban   450     2         96   88.2       730.
##  7       7 urban   450     2         62  110.        684.
##  8       8 urban   450     2          8  -91.6       374.
##  9       9 urban   450     2         15 -109.        371.
## 10      10 urban   450     2         70   20.7       611.
## # … with 90 more rows</code></pre>
<p>Let’s plot the data we created, along with the line of best fit.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" title="1"><span class="kw">ggplot</span>(urban, <span class="kw">aes</span>(dist_level, simple_rt)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb90-2" title="2"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">.2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb90-3" title="3"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<div class="figure" style="text-align: center"><span id="fig:plot-urban"></span>
<img src="04-interactions_files/figure-html/plot-urban-1.png" alt="*Effect of sonic distraction on simple RT, urban group.*" width="100%" />
<p class="caption">
Figure 4.1: <em>Effect of sonic distraction on simple RT, urban group.</em>
</p>
</div>
<p>Now let’s simulate data for the urban group. We assume that these participants should perhaps have a little higher intercept, maybe because they are less familiar with technology. Most importantly, we assume that they would have a steeper slope because they are more affected by the noise. Something like:</p>
<p><span class="math display">\[Y_i = 500 + 3 X_i + e_i\]</span></p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" title="1">b0_rural &lt;-<span class="st"> </span><span class="dv">500</span></a>
<a class="sourceLine" id="cb92-2" title="2">b1_rural &lt;-<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb92-3" title="3"></a>
<a class="sourceLine" id="cb92-4" title="4">rural &lt;-<span class="st"> </span><span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb92-5" title="5">  <span class="dt">subj_id =</span> <span class="dv">1</span><span class="op">:</span>n_subj <span class="op">+</span><span class="st"> </span>n_subj,</a>
<a class="sourceLine" id="cb92-6" title="6">  <span class="dt">group =</span> <span class="st">&quot;rural&quot;</span>,</a>
<a class="sourceLine" id="cb92-7" title="7">  <span class="dt">b0 =</span> b0_rural,</a>
<a class="sourceLine" id="cb92-8" title="8">  <span class="dt">b1 =</span> b1_rural,</a>
<a class="sourceLine" id="cb92-9" title="9">  <span class="dt">dist_level =</span> <span class="kw">sample</span>(<span class="dv">0</span><span class="op">:</span>n_subj, n_subj, <span class="dt">replace =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb92-10" title="10">  <span class="dt">err =</span> <span class="kw">rnorm</span>(n_subj, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">80</span>),</a>
<a class="sourceLine" id="cb92-11" title="11">  <span class="dt">simple_rt =</span> b0 <span class="op">+</span><span class="st"> </span>b1 <span class="op">*</span><span class="st"> </span>dist_level <span class="op">+</span><span class="st"> </span>err)</a></code></pre></div>
<p>Now let’s plot the data from the two groups side by side.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" title="1">all_data &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(urban, rural)</a>
<a class="sourceLine" id="cb93-2" title="2"></a>
<a class="sourceLine" id="cb93-3" title="3"><span class="kw">ggplot</span>(all_data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">group =</span> <span class="kw">fct_relevel</span>(group, <span class="st">&quot;urban&quot;</span>)), </a>
<a class="sourceLine" id="cb93-4" title="4">       <span class="kw">aes</span>(dist_level, simple_rt, <span class="dt">colour =</span> group)) <span class="op">+</span></a>
<a class="sourceLine" id="cb93-5" title="5"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb93-6" title="6"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb93-7" title="7"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>group) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb93-8" title="8"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</a></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<div class="figure" style="text-align: center"><span id="fig:combined-plot"></span>
<img src="04-interactions_files/figure-html/combined-plot-1.png" alt="*Effect of sonic distraction on simple RT for urban and rural participants.*" width="100%" />
<p class="caption">
Figure 4.2: <em>Effect of sonic distraction on simple RT for urban and rural participants.</em>
</p>
</div>
<p>Here we see very clearly the difference in slope that we built into our data. How do we test whether the two slopes are significantly different? To do this, we can’t have two separate regressions. We need to bring the two regression lines into the same model. How do we do this?</p>
<p>Note that we can represent one of the regression lines in terms of ‘offset’ values from the other. We (arbitrarily) choose one group as our ‘baseline’ group, and represent the y-intercept and slope of the other group as offsets from this baseline. So if we choose the urban group as our baseline, we can express the y-intercept and slope for the rural group in terms of two offsets, <span class="math inline">\(\beta_2\)</span> and <span class="math inline">\(\beta_3\)</span>, for the y-intercept and slope, respectively.</p>
<ul>
<li>y-intercept: <span class="math inline">\(\beta_{0\_rural} = \beta_{0\_urban} + \beta_2\)</span></li>
<li>slope: <span class="math inline">\(\beta_{1\_rural} = \beta_{1\_urban} + \beta_3\)</span></li>
</ul>
<p>Our urban group had parameters <span class="math inline">\(\beta_{0\_urban} = 450\)</span> (<code>b0_urban &lt;- 450</code>) and <span class="math inline">\(\beta_{1\_urban} = 2\)</span> (<code>b1_urban &lt;- 2</code>), whereas the rural broup had <span class="math inline">\(\beta_{0\_rural} = 500\)</span> (<code>b0_rural &lt;- 500</code>) and <span class="math inline">\(\beta_{1\_rural} = 3\)</span> (<code>b1_rural &lt;- 3</code>). It directly follows that <span class="math inline">\(\beta_2 = 50\)</span> and <span class="math inline">\(\beta_3 = 1\)</span> for our simulated example.</p>
<p>So our two regression models are now:</p>
<p><span class="math display">\[Y_{i\_urban} = \beta_{0\_urban} + \beta_{1\_urban} X_i + e_i\]</span></p>
<p>and</p>
<p><span class="math display">\[Y_{i\_rural} = (\beta_{0\_urban} + \beta_2) + (\beta_{1\_urban} + \beta_3) X_i + e_i.\]</span></p>
<p>OK, we feel like we’re closer to getting these into a single regression model. Here’s the final trick. We define an additional dummy predictor variable that takes on the value 0 for the urban group (which we chose as our ‘baseline’ group) and 1 for the other group. Our final model takes the following form.</p>
<div class="try">
<p><strong>Regression model with a continuous-by-categorical interaction.</strong></p>
<p><span class="math display">\[Y_{i} = \beta_0 + \beta_1 X_{1i} + \beta_2 X_{2i} + \beta_3 X_{1i} X_{2i} + e_{i}\]</span></p>
<p>where</p>
<ul>
<li><span class="math inline">\(X_{1i}\)</span> is the continous predictor, and</li>
<li><span class="math inline">\(X_{2i}\)</span> is a dummy-coded variable taking on 0 for the baseline, 1 for the alternative group.</li>
</ul>
<p>Interpretation of parameters:</p>
<ul>
<li><span class="math inline">\(\beta_0\)</span>: y-intercept for the baseline group;</li>
<li><span class="math inline">\(\beta_1\)</span>: slope for the baseline group;</li>
<li><span class="math inline">\(\beta_2\)</span>: offset to y-intercept for the alternative group;</li>
<li><span class="math inline">\(\beta_3\)</span>: offset to slope for the alternative group.</li>
</ul>
<p>Estimation in R:</p>
<p><code>lm(Y ~ X1 + X2 + X1:X2, data)</code> or, as a shortcut:</p>
<p><code>lm(Y ~ X1 * X2)</code> where <code>*</code> means “all possible main effects and interactions of X1 and X2”</p>
</div>
<p>The term associated with <span class="math inline">\(\beta_3\)</span> is an <strong>interaction term</strong>, where the predictor is the product of predictor values. Let’s now show that the above GLM gives us the two regression lines that we want. Plugging in 0 for <span class="math inline">\(X_{2i}\)</span> and reducing gives us</p>
<p><span class="math display">\[Y_{i} = \beta_0 + \beta_1 X_{1i} + \beta_2 0 + \beta_3 X_{1i} 0 + e_i\]</span></p>
<p>which is just</p>
<p><span class="math display">\[Y_{i} = \beta_0 + \beta_1 X_{1i} + e_i,\]</span></p>
<p>the regression equation for our baseline (urban) group. Compare this to <span class="math inline">\(Y_{i\_urban}\)</span> above.</p>
<p>Plugging in 1 for <span class="math inline">\(X_{2i}\)</span> should give us the equation for our rural group. We get</p>
<p><span class="math display">\[Y_{i} = \beta_0 + \beta_1 X_{1i} + \beta_2 1 + \beta_3 X_{1i} 1 + e_i\]</span></p>
<p>which, after reducing and applying a little algebra, can also be expressed as</p>
<p><span class="math display">\[Y_{i} = \beta_0 + \beta_2 + (\beta_1 + \beta_3) X_{1i} + e_i.\]</span></p>
<p>Compare this to <span class="math inline">\(Y_{i\_rural}\)</span> above. The dummy-coding trick works!</p>
<p>Now let’s see how to estimate the regression in R. Let’s say we wanted to test the hypothesis that the slopes for the two lines are different. Note that this just amounts to testing the null hypothesis that <span class="math inline">\(\beta_3 = 0\)</span>, because <span class="math inline">\(\beta_3\)</span> is our slope offset.</p>
<p>We have already created the dataset <code>all_data</code> combining the simulated data for our two groups. The way we express our model using R formula syntax is <code>Y ~ X1 + X2 + X1:X2</code> where <code>X1:X2</code> tells R to create a predictor that is the product of predictors X1 and X2. There is a shortcut <code>Y ~ X1 * X2</code> which tells R to calculate all possible main effects and interactions. First we’ll add a dummy predictor to our model, storing the result in <code>all_data2</code>.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" title="1">all_data2 &lt;-<span class="st"> </span>all_data <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb95-2" title="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">grp =</span> <span class="kw">if_else</span>(group <span class="op">==</span><span class="st"> &quot;rural&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>))</a></code></pre></div>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" title="1">sonic_mod &lt;-<span class="st"> </span><span class="kw">lm</span>(simple_rt <span class="op">~</span><span class="st"> </span>dist_level <span class="op">+</span><span class="st"> </span>grp <span class="op">+</span><span class="st"> </span>dist_level<span class="op">:</span>grp, all_data2)</a>
<a class="sourceLine" id="cb96-2" title="2"></a>
<a class="sourceLine" id="cb96-3" title="3"><span class="kw">summary</span>(sonic_mod)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = simple_rt ~ dist_level + grp + dist_level:grp, data = all_data2)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -261.130  -50.749    3.617   62.304  191.211 
## 
## Coefficients:
##                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    460.1098    15.5053  29.674  &lt; 2e-16 ***
## dist_level       1.9123     0.2620   7.299 7.07e-12 ***
## grp              4.8250    21.7184   0.222    0.824    
## dist_level:grp   1.5865     0.3809   4.166 4.65e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 81.14 on 196 degrees of freedom
## Multiple R-squared:  0.5625,	Adjusted R-squared:  0.5558 
## F-statistic: 83.99 on 3 and 196 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Can you identify the values of the regression coefficients in the output?</p>
</div>
<div id="categorical-by-categorical-interactions" class="section level2">
<h2><span class="header-section-number">4.4</span> Categorical-by-Categorical Interactions</h2>
<p><strong>Factorial designs</strong> are very common in psychology, and are most often analyzed using ANOVA-based techniques, which can obscure that they are also just models.</p>
<p>A factorial design is one in which the predictors (IVs) are all categorical: each is a <strong>factor</strong> having a fixed number of <strong>levels</strong>. In a full-factorial design, the factors are fully crossed with each other such that each possible combination of factors is represented. We call each unique combination a <strong>cell</strong> of the design. You will often hear designs referred to as “a two-by-two design” (2x2), which means that there are two factors, each of which has three levels. A “three-by-three” (3x3) design is one where there are two factors, each with three levels; a “two-by-two-by-two” 2x2x2 design is one in which there are three factors, each with two levels; and so on.</p>
<p>Typically, factorial designs are given a tabular representation, showing all the combinations of factor levels. Below is a tabular representation of a 2x2 design.</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
<span class="math inline">\(B_1\)</span>
</th>
<th style="text-align:left;">
<span class="math inline">\(B_2\)</span>
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<span class="math inline">\(A_1\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(AB_{11}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(AB_{12}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(A_2\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(AB_{21}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(AB_{22}\)</span>
</td>
</tr>
</tbody>
</table>
<p>A 3x2 design might be shown as follows.</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
<span class="math inline">\(B_1\)</span>
</th>
<th style="text-align:left;">
<span class="math inline">\(B_2\)</span>
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<span class="math inline">\(A_1\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(AB_{11}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(AB_{12}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(A_2\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(AB_{21}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(AB_{22}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(A_3\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(AB_{31}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(AB_{32}\)</span>
</td>
</tr>
</tbody>
</table>
<p>And finally, here’s a 2x2x2 design.</p>
<p><span class="math display">\[C_1\]</span></p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
<span class="math inline">\(B_1\)</span>
</th>
<th style="text-align:left;">
<span class="math inline">\(B_2\)</span>
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<span class="math inline">\(A_1\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(ABC_{111}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(ABC_{121}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(A_2\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(ABC_{211}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(ABC_{221}\)</span>
</td>
</tr>
</tbody>
</table>
<p><span class="math display">\[C_2\]</span></p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
<span class="math inline">\(B_1\)</span>
</th>
<th style="text-align:left;">
<span class="math inline">\(B_2\)</span>
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<span class="math inline">\(A_1\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(ABC_{112}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(ABC_{122}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(A_2\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(ABC_{212}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(ABC_{222}\)</span>
</td>
</tr>
</tbody>
</table>
<div class="warning">
<p>Don’t confuse <strong>factors</strong> and <strong>levels</strong>!</p>
<p>If you hear about a study that has three treatment groups (treatment A, treatment B, and control), that is not a “three-factor (three-way) design”. That is a one-factor (one-way) design with a single three-level factor (treatment condition).</p>
<p>There is no such thing as a factor that has only one level.</p>
</div>
<p>You can find out how many cells a design has by multiplying the number of levels of each factor. So, a 2x3x4 design would have 24 cells in the design.</p>
<div id="effects-of-cognitive-therapy-and-drug-therapy-on-mood" class="section level3">
<h3><span class="header-section-number">4.4.1</span> Effects of cognitive therapy and drug therapy on mood</h3>
<p>Let’s consider a simple factorial design and think about the types of patterns our data can show. After we get the concepts down from this concrete example, we’ll map them onto the more abstract statistical terminology.</p>
<p>Imagine you’ve running a study looking at effects of two different types of therapy for depressed patients, cognitive therapy and drug therapy. Half of the participants are randomly assigned to receive Cognitive Behavioral Therapy (CBT) and the other half get some other kind of control activity. Also, you further divide your patients through random assignment into a drug therapy group, whose members receive anti-depressants, and an control group, whose members receive a placebo. After treatment (or control/placebo), you measure their mood on a scale, with higher numbers corresponding to a more positive mood.</p>
<p>Let’s imagine that the means we obtain below are the population means, free of measurement or sampling error. We’ll take a moment to consider three different possible outcomes and what they imply about how these therapies might work independently or interactively to affect mood.</p>
<div class="warning">
<p>Keep in mind that you will almost <strong>never</strong> know the true means of any population that you care about, unless you have measured all members of the population, and done so without measurement error. Below, we’re talking about the hypothetical situation where you actually know the population means and can draw conclusions without any statistical tests. Any real sample means you look at will include sampling and measurement error, and any inferences you’d make would depend on the outcome of statistical tests, rather than the observed pattern of means.</p>
</div>
<div id="scenario-a" class="section level4 unnumbered">
<h4>Scenario A</h4>
<div class="figure" style="text-align: center"><span id="fig:scenario-a-plot"></span>
<img src="04-interactions_files/figure-html/scenario-a-plot-1.png" alt="*Scenario A, plot of cell means.*" width="50%" />
<p class="caption">
Figure 4.3: <em>Scenario A, plot of cell means.</em>
</p>
</div>
<p>Below is a table of <strong>cell means</strong> and <strong>marginal means</strong>. The cell means are the mean values of the dependent variable (mood) at each cell of the design. The marginal means (in the margins of the table) provide the means for each row and column.</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:scenario-a-means">Table 4.1: </span><em>Scenario A, Table of Means.</em>
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
No CBT
</th>
<th style="text-align:right;">
CBT
</th>
<th style="text-align:left;">
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Placebo
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:left;">
50
</td>
</tr>
<tr>
<td style="text-align:left;">
Drug
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:right;">
80
</td>
<td style="text-align:left;">
70
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
70
</td>
<td style="text-align:left;">
</td>
</tr>
</tbody>
</table>
<p>If this was our outcome, what would you conclude? Is cognitive therapy having an effect on mood? How about drug therapy. The answer to both of these questions is yes: The mean mood for people who got CBT (70; mean of column 2) is 20 points higher than the mean mood for people who didn’t (50; mean of column 1).</p>
<p>Likewise, people who got anti-depressants showed enhanced mood (70; mean of row 2) relative to people who got the placebo (50; mean of row 1).</p>
<p>Now we can also ask the following question: <strong>did the effect of cognitive therapy depend on whether or not the patient was simultaneously receiving drug therapy</strong>? The answer to this, is no. To see why, note that for the Placebo group (Row 1), cognitive therapy increased mood by 20 points (from 40 to 60). But this was the same for the Drug group: there was an increase of 20 points from 60 to 80. So, no evidence that the effect of one factor on mood depends on the other.</p>
</div>
<div id="scenario-b" class="section level4 unnumbered">
<h4>Scenario B</h4>
<div class="figure" style="text-align: center"><span id="fig:scenario-b-plot"></span>
<img src="04-interactions_files/figure-html/scenario-b-plot-1.png" alt="*Scenario B, plot of cell means.*" width="50%" />
<p class="caption">
Figure 4.4: <em>Scenario B, plot of cell means.</em>
</p>
</div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:scenario-b-means">Table 4.2: </span><em>Scenario B, Table of Means.</em>
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
No CBT
</th>
<th style="text-align:right;">
CBT
</th>
<th style="text-align:left;">
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Placebo
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:left;">
50
</td>
</tr>
<tr>
<td style="text-align:left;">
Drug
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:left;">
50
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:left;">
</td>
</tr>
</tbody>
</table>
<p>In this scenario, we also see that CBT improved mood (again, by 20 points), but there was no effect of Drug Therapy (equal marginal means of 50 for row 1 and row 2). We can also see here that the effect of CBT also didn’t depend upon Drug therapy; there is an increase of 20 points in each row.</p>
</div>
<div id="scenario-c" class="section level4 unnumbered">
<h4>Scenario C</h4>
<div class="figure" style="text-align: center"><span id="fig:scenario-c-plot"></span>
<img src="04-interactions_files/figure-html/scenario-c-plot-1.png" alt="*Scenario C, plot of cell means.*" width="50%" />
<p class="caption">
Figure 4.5: <em>Scenario C, plot of cell means.</em>
</p>
</div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:scenario-c-means">Table 4.3: </span><em>Scenario C, Table of Means.</em>
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
No CBT
</th>
<th style="text-align:right;">
CBT
</th>
<th style="text-align:left;">
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Placebo
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:left;">
50
</td>
</tr>
<tr>
<td style="text-align:left;">
Drug
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
90
</td>
<td style="text-align:left;">
70
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
75
</td>
<td style="text-align:left;">
</td>
</tr>
</tbody>
</table>
<p>Following the logic in previous sections, we see that overall, people who got cognitive therapy showed elevated mood relative to control (75 vs 45), and that people who got drug therapy also showed elevated mood relative to placebo (70 vs 50). But there is something else going on here: it seems that the effect of cognitive therapy on mood was <strong>more pronounced for patients who were also receiving drug therapy</strong>. For patients on antidepressants, there was a 40 point increase in mood relative to control (from 50 to 90; row 2 of the table). For patients who got the placebo, there was only a 20 point increase in mood, from 40 to 60 (row 1 of the table). So in this hypothetical scenario, <strong>the effect of cognitive therapy depends on whether or not there is also ongoing drug therapy.</strong></p>
</div>
</div>
<div id="effects-in-a-factorial-design" class="section level3">
<h3><span class="header-section-number">4.4.2</span> Effects in a factorial design</h3>
<p>If you understand the basic patterns of effects described in the previous section, you are then ready to map these concepts onto statistical language.</p>
<div id="main-effect" class="section level4">
<h4><span class="header-section-number">4.4.2.1</span> Main effect</h4>
<p><strong>Main effect</strong>: The effect of a factor on the DV <strong>ignoring</strong> the other factors in the design.</p>
<p>The test of a main effect is a test of the equivalence of marginal means. So in Scenario A above, when you compared the row means for drug therapy, you were assessing the main effect of this factor on mood. The null hypothesis would be that the two marginal means are equal:</p>
<p><span class="math display">\[\bar{Y}_{1..} = \bar{Y}_{2..}\]</span></p>
<p>where <span class="math inline">\(Y_{i..}\)</span> is the mean of row <span class="math inline">\(i\)</span>, ignoring the column factor.</p>
<p>If you have a factor with <span class="math inline">\(k\)</span> levels where <span class="math inline">\(k &gt; 2\)</span>, the null hypothesis for the main effect is</p>
<p><span class="math display">\[\bar{Y}_{1..} = \bar{Y}_{2..} = \ldots = \bar{Y}_{k..},\]</span></p>
<p>i.e., that all of the row (or column) means are equal.</p>
</div>
<div id="simple-effect" class="section level4">
<h4><span class="header-section-number">4.4.2.2</span> Simple effect</h4>
<p>A <strong>Simple effect</strong> is the effect of one factor at a specific level of another factor (i.e., holding that factor constant at a particular value).</p>
<p>So for instance, in Scenario C, we talked about the effect of CBT for participants in the anti-depressant group. In that case, the simple effect of CBT for participants receiving anti-depressants was 40 units.</p>
<p>We could also talk about the simple effect of drug therapy for patients who received cognitive therapy. In Scenario C, this was an increase in mood from 60 to 90 (column 2).</p>
</div>
<div id="interaction" class="section level4">
<h4><span class="header-section-number">4.4.2.3</span> Interaction</h4>
<p>We say that an <strong>interaction</strong> is present when the effect of one variable differs across the levels of another variable.</p>
<p>A more mathematical definition is that an interaction is present when the simple effects of one factor differ across the levels of another factor. We saw this in Scenario C, with a 40 point boost of CBT for the anti-depressant group, compared to a boost of 20 for the placebo group. Perhaps the elevated mood caused by the anti-depressants made patients more susceptable to CBT.</p>
<p>The main point here is that we say there is a simple interaction between A and B when the simple effects of A differ across the levels of B. You could also check whether the simple effects of B differ across A. It is not possible for one of these statements to be true without the other also being true, so it doesn’t matter which way you look at the simple effects.</p>
</div>
</div>
<div id="higher-order-designs" class="section level3">
<h3><span class="header-section-number">4.4.3</span> Higher-order designs</h3>
<p>Two-factor (also known as “two-way”) designs are very common in psychology and neuroscience, but sometimes you will also see designs with more than two factors, such as a 2x2x2 design.</p>
<p>To figure out the number of effects we have of different kinds, we use the formula below, which gives us the number of possible combinations for <span class="math inline">\(n\)</span> elements take <span class="math inline">\(k\)</span> at a time:</p>
<p><span class="math display">\[\frac{n!}{k!(n - k)!}\]</span></p>
<p>Rather than actually computing this by hand, we can just use the <code>choose(n, k)</code> function in R.</p>
<p>For any design with <span class="math inline">\(n\)</span> factors, you will have:</p>
<ul>
<li><span class="math inline">\(n\)</span> main effects;</li>
<li><span class="math inline">\(\frac{n!}{2!(n - 2)!}\)</span> two-way interactions;</li>
<li><span class="math inline">\(\frac{n!}{3!(n - 3)!}\)</span> three-way interactions;</li>
<li><span class="math inline">\(\frac{n!}{4!(n - 4)!}\)</span> four-way interactions… and so forth.</li>
</ul>
<p>So if we have a three-way design, e.g., a 2x2x2 with factors <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span>, and <span class="math inline">\(C\)</span>, we would have 3 main effects: <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span>, and <span class="math inline">\(C\)</span>. We would have <code>choose(3, 2)</code> = three two way interactions: <span class="math inline">\(AB\)</span>, <span class="math inline">\(AC\)</span>, and <span class="math inline">\(BC\)</span>, and <code>choose(3, 3)</code> = one three-way interaction: <span class="math inline">\(ABC\)</span>.</p>
<p>Three-way interactions are hard to interpret, but what they imply is that the <strong>simple interaction</strong> between any two given factors varies across the level of the third factor. For example, it would imply that the <span class="math inline">\(AB\)</span> interaction at <span class="math inline">\(C_1\)</span> would be different from the <span class="math inline">\(AB\)</span> interaction at <span class="math inline">\(C_2\)</span>.</p>
<p>If you have a four way design, you have four main effects, <code>choose(4, 2) =</code>6 two-way interactions, <code>choose(4, 3) =</code>4 three-way interactions, and one four-way interaction. It is next to impossible to interpret results from a four-way design, so keep your designs simple!</p>
<!-- ## A common fallacy
Comparing the significance of the simple effects is **not the same** as testing whether the simple effects are significantly different.
-->
</div>
</div>
<div id="the-glm-for-a-factorial-design" class="section level2">
<h2><span class="header-section-number">4.5</span> The GLM for a factorial design</h2>
<p>Now let’s look at the math behind these models. The typically way you’ll see the GLM for an ANOVA written for a 2x2 factorial design uses “ANOVA” notation, like so:</p>
<p><span class="math display">\[Y_{ijk} = \mu + A_i + B_j + AB_{ij} + S(AB)_{ijk}.\]</span></p>
<p>In the above formula,</p>
<ul>
<li><span class="math inline">\(Y_{ijk}\)</span> is the score for observation <span class="math inline">\(k\)</span> at level <span class="math inline">\(i\)</span> of <span class="math inline">\(A\)</span> and level <span class="math inline">\(j\)</span> of <span class="math inline">\(B\)</span>;</li>
<li><span class="math inline">\(\mu\)</span> is the grand mean;</li>
<li><span class="math inline">\(A_i\)</span> is the main effect of factor <span class="math inline">\(A\)</span> at level <span class="math inline">\(i\)</span> of <span class="math inline">\(A\)</span>;</li>
<li><span class="math inline">\(B_j\)</span> is the main effect of factor <span class="math inline">\(B\)</span> at level <span class="math inline">\(j\)</span> of <span class="math inline">\(B\)</span>;</li>
<li><span class="math inline">\(AB_{ij}\)</span> is the <span class="math inline">\(AB\)</span> interaction at level <span class="math inline">\(i\)</span> of <span class="math inline">\(A\)</span> and level <span class="math inline">\(j\)</span> of <span class="math inline">\(B\)</span>;</li>
<li><span class="math inline">\(S(AB)_{ijk}\)</span> is the residual.</li>
</ul>
<p>An important mathematical fact is that the individual main and interaction effects sum to zero, often written as:</p>
<ul>
<li><span class="math inline">\(\Sigma_i A_i = 0\)</span>;</li>
<li><span class="math inline">\(\Sigma_j B_j = 0\)</span>;</li>
<li><span class="math inline">\(\Sigma_{ij} AB_{ij} = 0\)</span>.</li>
</ul>
<p>The best way to understand these effects is to see them in a decomposition table. Study the decomposition table belo wfor 12 simulated observations from a 2x2 design with factors <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>. The indexes <span class="math inline">\(i\)</span>, <span class="math inline">\(j\)</span>, and <span class="math inline">\(k\)</span> are provided just to help you keep track of what observation you are dealing with. Remember that <span class="math inline">\(i\)</span> indexes the level of factor <span class="math inline">\(A\)</span>, <span class="math inline">\(j\)</span> indexes the level of factor <span class="math inline">\(B\)</span>, and <span class="math inline">\(k\)</span> indexes the observation number within the cell <span class="math inline">\(AB_{ij}\)</span>.</p>
<pre><code>## # A tibble: 12 x 9
##        Y     i     j     k    mu   A_i   B_j AB_ij   err
##    &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;
##  1    11     1     1     1    10     4    -2    -1     0
##  2    14     1     1     2    10     4    -2    -1     3
##  3     8     1     1     3    10     4    -2    -1    -3
##  4    17     1     2     1    10     4     2     1     0
##  5    15     1     2     2    10     4     2     1    -2
##  6    19     1     2     3    10     4     2     1     2
##  7     8     2     1     1    10    -4    -2     1     3
##  8     4     2     1     2    10    -4    -2     1    -1
##  9     3     2     1     3    10    -4    -2     1    -2
## 10    10     2     2     1    10    -4     2    -1     3
## 11     7     2     2     2    10    -4     2    -1     0
## 12     4     2     2     3    10    -4     2    -1    -3</code></pre>
<div id="estimation-equations" class="section level3">
<h3><span class="header-section-number">4.5.1</span> Estimation equations</h3>
<p>These are the equations you would used to estimate effects in an ANOVA.</p>
<ul>
<li><span class="math inline">\(\hat{\mu} = Y_{...}\)</span></li>
<li><span class="math inline">\(\hat{A}_i = Y_{i..} - \hat{\mu}\)</span></li>
<li><span class="math inline">\(\hat{B}_j = Y_{.j.} - \hat{\mu}\)</span></li>
<li><span class="math inline">\(\widehat{AB}_{ij} = Y_{ij.} - \hat{\mu} - \hat{A}_i - \hat{B}_j\)</span></li>
</ul>
<p>Note that the <span class="math inline">\(Y\)</span> variable with the dots in the subscripts are means of <span class="math inline">\(Y\)</span>, taken while ignoring anything appearing as a dot. So <span class="math inline">\(Y_{...}\)</span> is mean of <span class="math inline">\(Y\)</span>, <span class="math inline">\(Y_{i..}\)</span> is the mean of <span class="math inline">\(Y\)</span> at level <span class="math inline">\(i\)</span> of <span class="math inline">\(A\)</span>, <span class="math inline">\(Y_{.j.}\)</span> is the mean of <span class="math inline">\(Y\)</span> at level <span class="math inline">\(j\)</span> of <span class="math inline">\(B\)</span>, and <span class="math inline">\(Y_{ij.}\)</span> is the mean of <span class="math inline">\(Y\)</span> at level <span class="math inline">\(i\)</span> of <span class="math inline">\(A\)</span> and level <span class="math inline">\(j\)</span> of <span class="math inline">\(B\)</span>, i.e., the cell mean <span class="math inline">\(ij\)</span>.</p>
</div>
<div id="factorial-app" class="section level3">
<h3><span class="header-section-number">4.5.2</span> Factorial App</h3>
<p><img src="images/04-interactions_factorial_app.png" /></p>
<p><a href="https://shiny.psy.gla.ac.uk/Dale/factorial2" target="_blank">Launch this web application</a> and experiment with factorial designs until you understand the key concepts of main effects and interactions in a factorial design.</p>
</div>
</div>
<div id="code-your-own-categorical-predictors-in-factorial-designs" class="section level2">
<h2><span class="header-section-number">4.6</span> Code your own categorical predictors in factorial designs</h2>
<p>Many studies in psychology—especially experimental psychology—involve categorical independent variables. Analyzing data from these studies requires care in specifying the predictors, because the defaults in R are not ideal for experimental situations.</p>
<p>Let’s say you have 2x2 designed experiment with factors priming condition (priming vs. no priming) and linguistic structure (noun vs verb). These columns can be represented as type <code>character</code> or <code>factor</code>; in the latter case, they are implicitly converted to type <code>factor</code> before fitting the model, and then R will apply the default numerical coding for factors, which is ‘treatment’ (0, 1) coding.</p>
<p>If you’re used to running ANOVAs, the results that you get from fitting a linear model will <em>not</em> match ANOVA output, as we’ll see below. That is because you need to use a different coding scheme to get ANOVA-like output.</p>
<p>First, let’s define our little data set, <code>dat</code>.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" title="1">  <span class="co">## demo for why you should avoid factors</span></a>
<a class="sourceLine" id="cb99-2" title="2">  dat &lt;-<span class="st"> </span><span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb99-3" title="3">    <span class="dt">subject =</span> <span class="kw">factor</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">16</span>),</a>
<a class="sourceLine" id="cb99-4" title="4">    <span class="dt">priming =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;yes&quot;</span>, <span class="st">&quot;no&quot;</span>), <span class="dt">each =</span> <span class="dv">8</span>),</a>
<a class="sourceLine" id="cb99-5" title="5">    <span class="dt">structure =</span> <span class="kw">rep</span>(<span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;noun&quot;</span>, <span class="st">&quot;verb&quot;</span>), <span class="dt">each =</span> <span class="dv">4</span>), <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb99-6" title="6">    <span class="dt">RT =</span> <span class="kw">rnorm</span>(<span class="dv">16</span>, <span class="dv">800</span>, <span class="dv">20</span>))</a>
<a class="sourceLine" id="cb99-7" title="7"></a>
<a class="sourceLine" id="cb99-8" title="8">  dat</a></code></pre></div>
<pre><code>## # A tibble: 16 x 4
##    subject priming structure    RT
##    &lt;fct&gt;   &lt;chr&gt;   &lt;chr&gt;     &lt;dbl&gt;
##  1 1       yes     noun       792.
##  2 2       yes     noun       771.
##  3 3       yes     noun       760.
##  4 4       yes     noun       811.
##  5 5       yes     verb       787.
##  6 6       yes     verb       820.
##  7 7       yes     verb       768.
##  8 8       yes     verb       806.
##  9 9       no      noun       791.
## 10 10      no      noun       824.
## 11 11      no      noun       817.
## 12 12      no      noun       790.
## 13 13      no      verb       790.
## 14 14      no      verb       813.
## 15 15      no      verb       810.
## 16 16      no      verb       763.</code></pre>
<p>This is between subjects data, so we can fit a model using <code>lm()</code>. In the model, we include effects of <code>priming</code> and <code>structure</code> as well as their interaction. Instead of typing <code>priming + structure + priming:structure</code> we can simply type the shortcut <code>priming * structure</code>.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" title="1">  ps_mod &lt;-<span class="st"> </span><span class="kw">lm</span>(RT <span class="op">~</span><span class="st"> </span>priming <span class="op">*</span><span class="st"> </span>structure, dat)</a>
<a class="sourceLine" id="cb101-2" title="2"></a>
<a class="sourceLine" id="cb101-3" title="3">  <span class="kw">summary</span>(ps_mod)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = RT ~ priming * structure, data = dat)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -30.782 -14.711   2.036  16.466  27.755 
## 
## Coefficients:
##                          Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                805.57      10.83  74.409   &lt;2e-16 ***
## primingyes                 -22.08      15.31  -1.442    0.175    
## structureverb              -11.49      15.31  -0.750    0.468    
## primingyes:structureverb    23.20      21.65   1.071    0.305    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 21.65 on 12 degrees of freedom
## Multiple R-squared:  0.1481,	Adjusted R-squared:  -0.06493 
## F-statistic: 0.6951 on 3 and 12 DF,  p-value: 0.5726</code></pre>
<p>Note that in the output the predictors are shown as <code>primingyes</code> and <code>structureverb</code>. The value <code>yes</code> is a level of <code>priming</code>; the level <strong>not shown</strong> is the one chosen as baseline, and in the default treatment coding scheme, the not-shown level (<code>no</code>) is coded as 0, and the shown level (<code>yes</code>) is coded as 1. Likewise, for <code>structure</code>, <code>noun</code> is coded as 0 and <code>verb</code> is coded as 1.</p>
<p>This is not ideal, for reasons we will discuss further below. But I want to show you a further quirk of using factor variables as predictors.</p>
<p>Let’s say we wanted to test the effect of <code>priming</code> by itself using model comparison. To do this, we would fit another model where we exclude this effect while keeping the interaction. Despite what you may have heard to the contrary, in a fully randomized, balanced experiment, all factors are orthogonal, and so it is completely legitimate to drop a main effect while leaving an interaction term in the model.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" title="1">  ps_mod_nopriming &lt;-<span class="st"> </span><span class="kw">lm</span>(RT <span class="op">~</span><span class="st"> </span>structure <span class="op">+</span><span class="st"> </span>priming<span class="op">:</span>structure, dat)</a></code></pre></div>
<p>OK, now that we’ve dropped <code>priming</code>, we should have 3 parameter estimates instead of 4. Let’s check.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" title="1">  <span class="co">## not right!</span></a>
<a class="sourceLine" id="cb104-2" title="2">  <span class="kw">coef</span>(ps_mod_nopriming)</a></code></pre></div>
<pre><code>##              (Intercept)            structureverb structurenoun:primingyes 
##               805.566187               -11.485457               -22.081224 
## structureverb:primingyes 
##                 1.117333</code></pre>
<p>There are still 4 of them, and we’re suddenly getting <code>primingyes:structureverb</code>. This is weird and <em>not at all</em> what we intended. If we try to do the model comparison:</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb106-1" title="1">  <span class="co">## nonsense result</span></a>
<a class="sourceLine" id="cb106-2" title="2">  <span class="kw">anova</span>(ps_mod_nopriming, ps_mod)</a></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Model 1: RT ~ structure + priming:structure
## Model 2: RT ~ priming * structure
##   Res.Df  RSS Df  Sum of Sq F Pr(&gt;F)
## 1     12 5626                       
## 2     12 5626  0 9.0949e-13</code></pre>
<p>we’d get nonsensical results.</p>
<p>Is this a bug? No. It was a (in my view, heavy handed) design choice by the R creators to try to prevent everyone from doing something that at least some of us should be able to do at least some of the time.</p>
<p>But we can do whatever we please if instead of using factors we define our own numerical predictors. This adds a bit of work but avoids other headaches and mistakes that we might make by using factors. Also, being very explicit about how predictors are defined is probably a good thing.</p>
<p>You’ll sometimes need <code>factor</code> variables. I often use them to get things to plot in the right way using <code>ggplot2</code>, or when I need to tabulating observations and there are some combinations with zero counts. But I recommend against using <code>factors</code> in statistical models, especially if your model includes interactions. Use numerical predictors instead.</p>
</div>
<div id="coding-schemes-for-categorical-variables" class="section level2">
<h2><span class="header-section-number">4.7</span> Coding schemes for categorical variables</h2>
<p>Many experimentalists who are trying to make the leap from ANOVA to linear mixed-effects models (LMEMs) in R struggle with the coding of categorical predictors. It is unexpectedly complicated, and the defaults provided in R turn out to be wholly inappropriate for factorial experiments. Indeed, using those defaults with factorial experiments can lead researchers to draw erroneous conclusions from their data.</p>
<p>To keep things simple, we’ll start with situations where design factors have no more than two levels before moving on to designs with more than three levels.</p>
<div id="simple-versus-main-effects" class="section level3">
<h3><span class="header-section-number">4.7.1</span> Simple versus main effects</h3>
<p>It is important that you understand the difference between a <strong>simple effect</strong> and a <strong>main effect</strong>, and between a <strong>simple interaction</strong> and a <strong>main interaction</strong> in a three-way design.</p>
<p>In an <span class="math inline">\(A{\times}B\)</span> design, the simple effect of <span class="math inline">\(A\)</span> is the effect of <span class="math inline">\(A\)</span> <strong>controlling</strong> for <span class="math inline">\(B\)</span>, while the main effect of <span class="math inline">\(A\)</span> is the effect of <span class="math inline">\(A\)</span> <strong>ignoring</strong> <span class="math inline">\(B\)</span>. Another way of looking at this is to consider the cell means (<span class="math inline">\(\bar{Y}_{11}\)</span>, <span class="math inline">\(\bar{Y}_{12}\)</span>, <span class="math inline">\(\bar{Y}_{21}\)</span>, and <span class="math inline">\(\bar{Y}_{22}\)</span>) and marginal means (<span class="math inline">\(\bar{Y}_{1.}\)</span>, <span class="math inline">\(\bar{Y}_{2.}\)</span>, <span class="math inline">\(\bar{Y}_{.1}\)</span>, and <span class="math inline">\(\bar{Y}_{.2}\)</span>) in a factorial design. (The dot subscript tells you to “ignore” the dimension containing the dot; e.g., <span class="math inline">\(\bar{Y}_{.1}\)</span> tells you to take the mean of the first column ignoring the row variable.) To test the main effect of A is to test the null hypothesis that <span class="math inline">\(\bar{Y}_{1.}=\bar{Y}_{2.}\)</span>. To test a simple effect of <span class="math inline">\(A\)</span>—the effect of <span class="math inline">\(A\)</span> at a particular level of <span class="math inline">\(B\)</span>—would be, for instance, to test the null hypothesis that <span class="math inline">\(\bar{Y}_{11}=\bar{Y}_{21}\)</span>.</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
</th>
<th style="text-align:center;">
<span class="math inline">\(B_1\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(B_2\)</span>
</th>
<th style="text-align:center;">
</th>
<th style="text-align:center;">
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<span class="math inline">\(A_1\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{11}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{12}\)</span>
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{1.}\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">\(A_2\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{21}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{22}\)</span>
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{2.}\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{.1}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{.2}\)</span>
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
</tr>
</tbody>
</table>
<p>The distinction between <strong>simple interactions</strong> and <strong>main interactions</strong> has the same logic: the simple interaction of <span class="math inline">\(AB\)</span> in an <span class="math inline">\(ABC\)</span> design is the interaction of <span class="math inline">\(AB\)</span> at a particular level of <span class="math inline">\(C\)</span>; the main interaction of <span class="math inline">\(AB\)</span> is the interaction <strong>ignoring</strong> C. The latter is what we are usually talking about when we talk about lower-order interactions in a three-way design. It is also what we are given in the output from standard ANOVA procedures, e.g., the <code>aov()</code> function in R, SPSS, SAS, etc.</p>
</div>
<div id="the-key-coding-schemes" class="section level3">
<h3><span class="header-section-number">4.7.2</span> The key coding schemes</h3>
<p>Generally, the choice of a coding scheme impacts the interpretation of:</p>
<ol style="list-style-type: decimal">
<li>the intercept term; and</li>
<li>the interpretation of the tests for all but the highest-order effects and interactions in a factorial design.</li>
</ol>
<p>It also can influence the interpretation/estimation of random effects in a mixed-effects model (see <a href="https://talklab.psy.gla.ac.uk/simgen/rsonly.html">this blog post</a> for further discussion). If you have a design with only a single two-level factor, and are using a <a href="https://www.sciencedirect.com/science/article/pii/S0749596X12001180">maximal random-effects structure</a>, the choice of coding scheme doesn’t really matter.</p>
<p>There are many possible coding schemes (see <code>?contr.treatment</code> for more information). The most relevant ones are <strong>treatment</strong>, <strong>sum</strong>, and <strong>deviation</strong>. Sum and deviation coding can be seen as special cases of <strong>effect</strong> coding; by effect coding, people generally mean codes that sum to zero.</p>
<p>For a two-level factor, you would use the following codes:</p>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Scheme
</th>
<th style="text-align:right;">
<span class="math inline">\(A_1\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(A_2\)</span>
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Treatment (dummy)
</td>
<td style="text-align:right;">
<span class="math inline">\(0\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(1\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Sum
</td>
<td style="text-align:right;">
<span class="math inline">\(-1\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(1\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Deviation
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{2}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(\frac{1}{2}\)</span>
</td>
</tr>
</tbody>
</table>
<dl>
<dt>The default in R is to use treatment coding for any variable defined as a =factor= in the model (see <code>?factor</code> and <code>?contrasts</code> for information). To see why this is not ideal for factorial designs, consider a 2x2x2 factorial design with factors <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span> and <span class="math inline">\(C\)</span>. We will just consider a fully between-subjects design with only one observation per subject as this allows us to use the simplest possible error structure. We would fit such a model using <code>lm()</code>:</dt>
<dd><p>lm(Y ~ A * B * C)</p>
</dd>
</dl>
<p>The figure below spells out the notation for the various cell and marginal means for a 2x2x2 design.</p>
<p><span class="math display">\[C_1\]</span></p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
</th>
<th style="text-align:center;">
<span class="math inline">\(B_1\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(B_2\)</span>
</th>
<th style="text-align:center;">
</th>
<th style="text-align:center;">
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<span class="math inline">\(A_1\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{111}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{121}\)</span>
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{1.1}\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">\(A_2\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{211}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{221}\)</span>
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{2.1}\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{.11}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{.21}\)</span>
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
</tr>
</tbody>
</table>
<p><span class="math display">\[C_2\]</span></p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
</th>
<th style="text-align:center;">
<span class="math inline">\(B_1\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(B_2\)</span>
</th>
<th style="text-align:center;">
</th>
<th style="text-align:center;">
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<span class="math inline">\(A_1\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{112}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{122}\)</span>
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{1.2}\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">\(A_2\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{212}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{222}\)</span>
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{2.2}\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{.12}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{.22}\)</span>
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
</tr>
</tbody>
</table>
<p>The table below provides the interpretation for various effects in the model under the three different coding schemes. Note that <span class="math inline">\(Y\)</span> is the dependent variable, and the dots in the subscript mean to “ignore” the corresponding dimension. Thus, <span class="math inline">\(\bar{Y}_{.1.}\)</span> is the mean of B_1 (ignoring factors <span class="math inline">\(A\)</span> and <span class="math inline">\(C\)</span>) and <span class="math inline">\(\bar{Y}_{...}\)</span> is the “grand mean” (ignoring all factors).</p>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
term
</th>
<th style="text-align:center;">
treatment
</th>
<th style="text-align:center;">
sum
</th>
<th style="text-align:center;">
deviation
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<span class="math inline">\(\mu\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{111}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{...}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{...}\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">\(A\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{211} - \bar{Y}_{111}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\frac{(\bar{Y}_{2..} - \bar{Y}_{1..})}{2}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{2..} - \bar{Y}_{1..}\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">\(B\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{121} - \bar{Y}_{111}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\frac{(\bar{Y}_{.2.} - \bar{Y}_{.1.})}{2}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{.2.} - \bar{Y}_{.1.}\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">\(C\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{112} - \bar{Y}_{111}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\frac{(\bar{Y}_{..2} - \bar{Y}_{..1})}{2}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{..2} - \bar{Y}_{..1}\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">\(AB\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\((\bar{Y}_{221} - \bar{Y}_{121}) - (\bar{Y}_{211} - \bar{Y}_{111})\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\frac{(\bar{Y}_{22.} - \bar{Y}_{12.}) - (\bar{Y}_{21.} - \bar{Y}_{11.})}{4}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\((\bar{Y}_{22.} - \bar{Y}_{12.}) - (\bar{Y}_{21.} - \bar{Y}_{11.})\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">\(AC\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\((\bar{Y}_{212} - \bar{Y}_{211}) - (\bar{Y}_{112} - \bar{Y}_{111})\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\frac{(\bar{Y}_{2.2} - \bar{Y}_{1.2}) - (\bar{Y}_{2.1} - \bar{Y}_{1.1})}{4}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\((\bar{Y}_{2.2} - \bar{Y}_{1.2}) - (\bar{Y}_{2.1} - \bar{Y}_{1.1})\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">\(BC\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\((\bar{Y}_{122} - \bar{Y}_{112}) - (\bar{Y}_{121} - \bar{Y}_{111})\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\frac{(\bar{Y}_{.22} - \bar{Y}_{.12}) - (\bar{Y}_{.21} - \bar{Y}_{.11})}{4}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\((\bar{Y}_{.22} - \bar{Y}_{.12}) - (\bar{Y}_{.21} - \bar{Y}_{.11})\)</span>
</td>
</tr>
</tbody>
</table>
<p>For the three way <span class="math inline">\(A \times B \times C\)</span> interaction:</p>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
scheme
</th>
<th style="text-align:center;">
interpretation
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
treatment
</td>
<td style="text-align:center;">
<span class="math inline">\(\displaystyle\left[\displaystyle\left(\bar{Y}_{221} - \bar{Y}_{121}\right) - \displaystyle\left(\bar{Y}_{211} - \bar{Y}_{111}\right)\right] - \displaystyle\left[\displaystyle\left(\bar{Y}_{222} - \bar{Y}_{122}\right) - \displaystyle\left(\bar{Y}_{212} - \bar{Y}_{112}\right)\right]\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
sum
</td>
<td style="text-align:center;">
<span class="math inline">\(\frac{\displaystyle\left[\displaystyle\left(\bar{Y}_{221} - \bar{Y}_{121}\right) - \displaystyle\left(\bar{Y}_{211} - \bar{Y}_{111}\right)\right] - \displaystyle\left[\displaystyle\left(\bar{Y}_{222} - \bar{Y}_{122}\right) - \displaystyle\left(\bar{Y}_{212} - \bar{Y}_{112}\right)\right]}{8}\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
deviation
</td>
<td style="text-align:center;">
<span class="math inline">\(\displaystyle\left[\displaystyle\left(\bar{Y}_{221} - \bar{Y}_{121}\right) - \displaystyle\left(\bar{Y}_{211} - \bar{Y}_{111}\right)\right] - \displaystyle\left[\displaystyle\left(\bar{Y}_{222} - \bar{Y}_{122}\right) - \displaystyle\left(\bar{Y}_{212} - \bar{Y}_{112}\right)\right]\)</span>
</td>
</tr>
</tbody>
</table>
<p>Note that the inferential tests of <span class="math inline">\(A \times B \times C\)</span> will all have the same outcome, despite the parameter estimate for sum coding being one-eighth of that for the other schemes. For all lower-order effects, sum and deviation coding will give different parameter estimates but identical inferential outcomes. Both of these schemes provide identical tests of the canonical main effects and main interactions for a three-way ANOVA. In contrast, treatment (dummy) coding will provide inferential tests of simple effects and simple interactions. So, if what you are interested in getting are the “canonical” tests from ANOVA, use sum or deviation coding.</p>
</div>
<div id="what-about-factors-with-more-than-two-levels" class="section level3">
<h3><span class="header-section-number">4.7.3</span> What about factors with more than two levels?</h3>
<p>A factor with <span class="math inline">\(k\)</span> levels requires <span class="math inline">\(k-1\)</span> variables. Each predictor contrasts a particular “target” level of the factor with a level that you (arbitrarily) choose as the “baseline” level. For instance, for a three-level factor <span class="math inline">\(A\)</span> with <span class="math inline">\(A1\)</span> chosen as the baseline, you’d have two predictor variables, one of which compares <span class="math inline">\(A2\)</span> to <span class="math inline">\(A1\)</span> and the other of which compares <span class="math inline">\(A3\)</span> to <span class="math inline">\(A1\)</span>.</p>
<p>For treatment (dummy) coding, the target level is set to 1, otherwise 0.</p>
<p>For sum coding, the levels must sum to zero, so for a given predictor, the target level is given the value 1, the baseline level is given the value -1, and any other level is given the value 0.</p>
<p>For deviation coding, the values must also sum to 0. Deviation coding is recommended whenever you are trying to draw ANOVA-style inferences. Under this scheme, the target level gets the value <span class="math inline">\(\frac{k-1}{k}\)</span> while any non-target level gets the value <span class="math inline">\(-\frac{1}{k}\)</span>.</p>
<p><strong>Fun fact</strong>: Mean-centering treatment codes (on balanced data) will give you deviation codes.</p>
</div>
<div id="example-three-level-factor" class="section level3">
<h3><span class="header-section-number">4.7.4</span> Example: Three-level factor</h3>
<div id="treatment-dummy" class="section level4">
<h4><span class="header-section-number">4.7.4.1</span> Treatment (Dummy)</h4>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
level
</th>
<th style="text-align:right;">
A2v1
</th>
<th style="text-align:right;">
A3v1
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
A1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
A2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
A3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table>
</div>
<div id="sum" class="section level4">
<h4><span class="header-section-number">4.7.4.2</span> Sum</h4>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
level
</th>
<th style="text-align:right;">
A2v1
</th>
<th style="text-align:right;">
A3v1
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
A1
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:right;">
-1
</td>
</tr>
<tr>
<td style="text-align:left;">
A2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
A3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table>
</div>
<div id="deviation" class="section level4">
<h4><span class="header-section-number">4.7.4.3</span> Deviation</h4>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
level
</th>
<th style="text-align:right;">
A2v1
</th>
<th style="text-align:right;">
A3v1
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
A1
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{3}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{3}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
A2
</td>
<td style="text-align:right;">
<span class="math inline">\(\frac{2}{3}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{3}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
A3
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{3}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(\frac{2}{3}\)</span>
</td>
</tr>
</tbody>
</table>
</div>
<div id="example-five-level-factor" class="section level4">
<h4><span class="header-section-number">4.7.4.4</span> Example: Five-level factor</h4>
</div>
<div id="treatment-dummy-1" class="section level4">
<h4><span class="header-section-number">4.7.4.5</span> Treatment (Dummy)</h4>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
level
</th>
<th style="text-align:right;">
A2v1
</th>
<th style="text-align:right;">
A3v1
</th>
<th style="text-align:right;">
A4v1
</th>
<th style="text-align:right;">
A5v1
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
A1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
A2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
A3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
A4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
A5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table>
</div>
<div id="sum-1" class="section level4">
<h4><span class="header-section-number">4.7.4.6</span> Sum</h4>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
level
</th>
<th style="text-align:right;">
A2v1
</th>
<th style="text-align:right;">
A3v1
</th>
<th style="text-align:right;">
A4v1
</th>
<th style="text-align:right;">
A5v1
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
A1
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:right;">
-1
</td>
</tr>
<tr>
<td style="text-align:left;">
A2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
A3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
A4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
A5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table>
</div>
<div id="deviation-1" class="section level4">
<h4><span class="header-section-number">4.7.4.7</span> Deviation</h4>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
level
</th>
<th style="text-align:right;">
A2v1
</th>
<th style="text-align:right;">
A3v1
</th>
<th style="text-align:right;">
A4v1
</th>
<th style="text-align:right;">
A5v1
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
A1
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{5}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{5}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{5}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{5}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
A2
</td>
<td style="text-align:right;">
<span class="math inline">\(\frac{4}{5}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{5}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{5}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{5}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
A3
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{5}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(\frac{4}{5}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{5}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{5}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
A4
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{5}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{5}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(\frac{4}{5}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{5}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
A5
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{5}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{5}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{5}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(\frac{4}{5}\)</span>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="how-to-create-your-own-numeric-predictors" class="section level3">
<h3><span class="header-section-number">4.7.5</span> How to create your own numeric predictors</h3>
<p>Let’s assume that your data is contained in a table <code>dat</code> like the one below.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb108-1" title="1"> <span class="co">## create your own numeric predictors</span></a>
<a class="sourceLine" id="cb108-2" title="2"> <span class="co">## make an example table</span></a>
<a class="sourceLine" id="cb108-3" title="3"> dat &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">Y =</span> <span class="kw">rnorm</span>(<span class="dv">12</span>),</a>
<a class="sourceLine" id="cb108-4" title="4">               <span class="dt">A =</span> <span class="kw">rep</span>(<span class="kw">paste0</span>(<span class="st">&quot;A&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>), <span class="dt">each =</span> <span class="dv">4</span>))</a></code></pre></div>
<div class='solution'>
<button>
Click to view example data
</button>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
Y
</th>
<th style="text-align:left;">
A
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
-0.75
</td>
<td style="text-align:left;">
A1
</td>
</tr>
<tr>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:left;">
A1
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.22
</td>
<td style="text-align:left;">
A1
</td>
</tr>
<tr>
<td style="text-align:right;">
1.09
</td>
<td style="text-align:left;">
A1
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.42
</td>
<td style="text-align:left;">
A2
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.68
</td>
<td style="text-align:left;">
A2
</td>
</tr>
<tr>
<td style="text-align:right;">
2.09
</td>
<td style="text-align:left;">
A2
</td>
</tr>
<tr>
<td style="text-align:right;">
-1.37
</td>
<td style="text-align:left;">
A2
</td>
</tr>
<tr>
<td style="text-align:right;">
0.27
</td>
<td style="text-align:left;">
A3
</td>
</tr>
<tr>
<td style="text-align:right;">
0.47
</td>
<td style="text-align:left;">
A3
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.95
</td>
<td style="text-align:left;">
A3
</td>
</tr>
<tr>
<td style="text-align:right;">
0.16
</td>
<td style="text-align:left;">
A3
</td>
</tr>
</tbody>
</table>
</div>
<div id="the-mutate-if_else-case_when-approach-for-a-three-level-factor" class="section level4">
<h4><span class="header-section-number">4.7.5.1</span> The <code>mutate()</code> / <code>if_else()</code> / <code>case_when()</code> approach for a three-level factor</h4>
</div>
<div id="treatment" class="section level4">
<h4><span class="header-section-number">4.7.5.2</span> Treatment</h4>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb109-1" title="1">  <span class="co">## examples of three level factors</span></a>
<a class="sourceLine" id="cb109-2" title="2">  <span class="co">## treatment coding</span></a>
<a class="sourceLine" id="cb109-3" title="3">  dat_treat &lt;-<span class="st"> </span>dat <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb109-4" title="4"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">A2v1 =</span> <span class="kw">if_else</span>(A <span class="op">==</span><span class="st"> &quot;A2&quot;</span>, 1L, 0L),</a>
<a class="sourceLine" id="cb109-5" title="5">	   <span class="dt">A3v1 =</span> <span class="kw">if_else</span>(A <span class="op">==</span><span class="st"> &quot;A3&quot;</span>, 1L, 0L))</a></code></pre></div>
<div class="solution">
<button>
Click to view resulting table
</button>
<pre><code>## # A tibble: 12 x 4
##          Y A      A2v1  A3v1
##      &lt;dbl&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt;
##  1 -0.752  A1        0     0
##  2  0.0251 A1        0     0
##  3 -0.218  A1        0     0
##  4  1.09   A1        0     0
##  5 -0.417  A2        1     0
##  6 -0.683  A2        1     0
##  7  2.09   A2        1     0
##  8 -1.37   A2        1     0
##  9  0.268  A3        0     1
## 10  0.472  A3        0     1
## 11 -0.946  A3        0     1
## 12  0.155  A3        0     1</code></pre>
</div>
</div>
<div id="sum-2" class="section level4">
<h4><span class="header-section-number">4.7.5.3</span> Sum</h4>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb111-1" title="1"><span class="co">## sum coding</span></a>
<a class="sourceLine" id="cb111-2" title="2">dat_sum &lt;-<span class="st"> </span>dat <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb111-3" title="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">A2v1 =</span> <span class="kw">case_when</span>(A <span class="op">==</span><span class="st"> &quot;A1&quot;</span> <span class="op">~</span><span class="st"> </span><span class="op">-</span>1L, <span class="co"># baseline</span></a>
<a class="sourceLine" id="cb111-4" title="4">                          A <span class="op">==</span><span class="st"> &quot;A2&quot;</span> <span class="op">~</span><span class="st"> </span>1L,  <span class="co"># target</span></a>
<a class="sourceLine" id="cb111-5" title="5">                          <span class="ot">TRUE</span>      <span class="op">~</span><span class="st"> </span>0L), <span class="co"># anything else</span></a>
<a class="sourceLine" id="cb111-6" title="6">         <span class="dt">A3v1 =</span> <span class="kw">case_when</span>(A <span class="op">==</span><span class="st"> &quot;A1&quot;</span> <span class="op">~</span><span class="st"> </span><span class="op">-</span>1L, <span class="co"># baseline</span></a>
<a class="sourceLine" id="cb111-7" title="7">                          A <span class="op">==</span><span class="st"> &quot;A3&quot;</span> <span class="op">~</span><span class="st">  </span>1L, <span class="co"># target</span></a>
<a class="sourceLine" id="cb111-8" title="8">                          <span class="ot">TRUE</span>      <span class="op">~</span><span class="st"> </span>0L)) <span class="co"># anything else</span></a></code></pre></div>
<div class="solution">
<button>
Click to view resulting table
</button>
<pre><code>## # A tibble: 12 x 4
##          Y A      A2v1  A3v1
##      &lt;dbl&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt;
##  1 -0.752  A1       -1    -1
##  2  0.0251 A1       -1    -1
##  3 -0.218  A1       -1    -1
##  4  1.09   A1       -1    -1
##  5 -0.417  A2        1     0
##  6 -0.683  A2        1     0
##  7  2.09   A2        1     0
##  8 -1.37   A2        1     0
##  9  0.268  A3        0     1
## 10  0.472  A3        0     1
## 11 -0.946  A3        0     1
## 12  0.155  A3        0     1</code></pre>
</div>
</div>
<div id="deviation-2" class="section level4">
<h4><span class="header-section-number">4.7.5.4</span> Deviation</h4>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb113-1" title="1"><span class="co">## deviation coding</span></a>
<a class="sourceLine" id="cb113-2" title="2"><span class="co">## baseline A1</span></a>
<a class="sourceLine" id="cb113-3" title="3">dat_dev &lt;-<span class="st"> </span>dat <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb113-4" title="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">A2v1 =</span> <span class="kw">if_else</span>(A <span class="op">==</span><span class="st"> &quot;A2&quot;</span>, <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>, <span class="dv">-1</span><span class="op">/</span><span class="dv">3</span>), <span class="co"># target A2</span></a>
<a class="sourceLine" id="cb113-5" title="5">         <span class="dt">A3v1 =</span> <span class="kw">if_else</span>(A <span class="op">==</span><span class="st"> &quot;A3&quot;</span>, <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>, <span class="dv">-1</span><span class="op">/</span><span class="dv">3</span>)) <span class="co"># target A3</span></a></code></pre></div>
<div class="solution">
<button>
Click to view resulting table
</button>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb114-1" title="1">dat_dev</a></code></pre></div>
<pre><code>## # A tibble: 12 x 4
##          Y A       A2v1   A3v1
##      &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt;
##  1 -0.752  A1    -0.333 -0.333
##  2  0.0251 A1    -0.333 -0.333
##  3 -0.218  A1    -0.333 -0.333
##  4  1.09   A1    -0.333 -0.333
##  5 -0.417  A2     0.667 -0.333
##  6 -0.683  A2     0.667 -0.333
##  7  2.09   A2     0.667 -0.333
##  8 -1.37   A2     0.667 -0.333
##  9  0.268  A3    -0.333  0.667
## 10  0.472  A3    -0.333  0.667
## 11 -0.946  A3    -0.333  0.667
## 12  0.155  A3    -0.333  0.667</code></pre>
</div>
</div>
</div>
<div id="conclusion" class="section level3">
<h3><span class="header-section-number">4.7.6</span> Conclusion</h3>
<p><strong>The interpretation of all but the highest order effect depends on the coding scheme.</strong></p>
<p>With treatment coding, you are looking at <strong>simple</strong> effects and <strong>simple</strong> interactions, not <strong>main</strong> effects and <strong>main</strong> interactions.</p>
<p><strong>The parameter estimates for sum coding differs from deviation coding only in the magnitude of the parameter estimates, but have identical interpretations.</strong></p>
<p>Because it is not subject to the scaling effects seen under sum coding, deviation should be used by default for ANOVA-style designs.</p>
<p><strong>The default coding scheme for factors is R is “treatment” coding.</strong></p>
<p>So, anytime you declare a variable as type <code>factor</code> and use this variable as a predictor in your regression model, R will automatically create treatment-coded variables.</p>
<div class="warning">
<p><strong>Take-home message: when analyzing factorial designs in R using regression, to obtain the canonical ANOVA-style interpretations of main effects and interactions use deviation coding and NOT the default treatment coding.</strong></p>
</div>

</div>
</div>
</div>
<div class="psyteachr_footer">
  
</div>
<script>

/* update total correct if #total_correct exists */
update_total_correct = function() {
  if (t = document.getElementById("total_correct")) {
    t.innerHTML =
      document.getElementsByClassName("correct").length + " of " +
      document.getElementsByClassName("solveme").length + " correct";
  }
}

/* solution button toggling function */
b_func = function() {
  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "");
  }
  
  if (my_answer !== "" & real_answers.includes(my_answer)) {
    cl.add("correct");
  } else {
    cl.remove("correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol){
    var tol = JSON.parse(this.dataset.tol);  
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("correct");
    } else {
      cl.remove("correct");
    }  
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("correct");
    }  
  }
  
  update_total_correct();
}

window.onload = function() {
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('solution')) {
      buttons[i].onclick = b_func;
    }
  }
  
  /* set up solveme inputs */
  var solveme = document.getElementsByClassName("solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off"); 
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";
    
    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;
    
    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;
  }
  
  update_total_correct();
}

</script>
            </section>

          </div>
        </div>
      </div>
<a href="multiple-regression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="introducing-linear-mixed-effects-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"],
"google": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": {},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
