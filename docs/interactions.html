<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 4 Interactions | Learning Statistical Models Through Simulation in R</title>
<meta name="author" content="Dale J. Barr">
<meta name="description" content="Up to now, we've been focusing on estimating and interpreting the effect of a variable or linear combination of predictor variables on a response variable. However, there are often situations...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Chapter 4 Interactions | Learning Statistical Models Through Simulation in R">
<meta property="og:type" content="book">
<meta property="og:url" content="https://psyteachr.github.io/stat-models-v1/interactions.html">
<meta property="og:image" content="https://psyteachr.github.io/stat-models-v1/images/logos/logo.png">
<meta property="og:description" content="Up to now, we've been focusing on estimating and interpreting the effect of a variable or linear combination of predictor variables on a response variable. However, there are often situations...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 4 Interactions | Learning Statistical Models Through Simulation in R">
<meta name="twitter:description" content="Up to now, we've been focusing on estimating and interpreting the effect of a variable or linear combination of predictor variables on a response variable. However, there are often situations...">
<meta name="twitter:image" content="https://psyteachr.github.io/stat-models-v1/images/logos/logo.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-6NP3MF25W3"></script><script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'G-6NP3MF25W3');
  </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="include/psyteachr.css">
<link rel="stylesheet" href="include/webex.css">
<link rel="stylesheet" href="include/style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Learning Statistical Models Through Simulation in R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Overview</a></li>
<li><a class="" href="introduction.html"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="" href="correlation-and-regression.html"><span class="header-section-number">2</span> Correlation and regression</a></li>
<li><a class="" href="multiple-regression.html"><span class="header-section-number">3</span> Multiple regression</a></li>
<li><a class="active" href="interactions.html"><span class="header-section-number">4</span> Interactions</a></li>
<li><a class="" href="introducing-linear-mixed-effects-models.html"><span class="header-section-number">5</span> Introducing linear mixed-effects models</a></li>
<li><a class="" href="linear-mixed-effects-models-with-one-random-factor.html"><span class="header-section-number">6</span> Linear mixed-effects models with one random factor</a></li>
<li><a class="" href="linear-mixed-effects-models-with-crossed-random-factors.html"><span class="header-section-number">7</span> Linear mixed-effects models with crossed random factors</a></li>
<li><a class="" href="generalized-linear-mixed-effects-models.html"><span class="header-section-number">8</span> Generalized linear mixed-effects models</a></li>
<li><a class="" href="modeling-ordinal-data.html"><span class="header-section-number">9</span> Modeling Ordinal Data</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="symbols.html"><span class="header-section-number">A</span> Symbols</a></li>
<li><a class="" href="bibliography.html"><span class="header-section-number">B</span> Bibliography</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/psyteachr/stat-models-v1">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="interactions" class="section level1">
<h1>
<span class="header-section-number">4</span> Interactions<a class="anchor" aria-label="anchor" href="#interactions"><i class="fas fa-link"></i></a>
</h1>
<!-- understand a common fallacy regarding interactions -->
<p>Up to now, we've been focusing on estimating and interpreting the effect of a variable or linear combination of predictor variables on a response variable. However, there are often situations where the effect of one predictor on the response depends on the value of another predictor variable. We can actually estimate and interpret this dependency as well, by including an <strong>interaction</strong> term in our model.</p>
<div id="cont-by-cat" class="section level2">
<h2>
<span class="header-section-number">4.1</span> Continuous-by-Categorical Interactions<a class="anchor" aria-label="anchor" href="#cont-by-cat"><i class="fas fa-link"></i></a>
</h2>
<p>One common example of this is when you are interested in whether a linear relationship between a continous predictor and a continuous response is different for two groups.</p>
<p>Let's consider a simple fictional example. Say you are interested in the effects of sonic distraction on cognitive performance. Each participant in your study is randomly assigned to receive a particular amount of sonic distraction while they perform a simple reaction time task (respond as quickly as possible to a flashing light). You have a technique that allows you to automatically generate different levels of background noise (e.g., frequency and amplitude of city sounds, such as sirens, jackhammers, people yelling, glass breaking, etc.). Each participant performs the task for a randomly chosen level of distraction (0 to 100). Your hypothesis is that urban living makes people's task performance more immune to sonic distraction. You want to compare the relationship between distraction and performance for city dwellers to the relationship for people from quieter rural environments.</p>
<p>You have three variables:</p>
<ul>
<li>A continuous response variable, <code>mean_RT</code>, with higher levels reflecting slower RTs;</li>
<li>A continuous predictor variable, level of sonic distraction (<code>dist_level</code>), with higher levels indicating more distraction;</li>
<li>A factor with two levels, <code>group</code> (urban vs. rural).</li>
</ul>
<p>Let's start by simulating some data for the urban group. Let's assume that with zero distraction (silence), the average RT is about 450 milliseconds, and that with each unit increase on the distraction scale, RT increases about 2 ms. This gives us the following linear model:</p>
<p><span class="math display">\[Y_i = 450 + 2 X_i + e_i\]</span></p>
<p>where <span class="math inline">\(X_i\)</span> is the amount of sonic distraction.</p>
<p>Let's simulate data for 100 participants as below with <span class="math inline">\(\sigma = 80\)</span>, setting the seed before we begin.</p>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://tidyverse.tidyverse.org">"tidyverse"</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1031</span><span class="op">)</span>

<span class="va">n_subj</span> <span class="op">&lt;-</span> <span class="fl">100L</span>  <span class="co"># simulate data for 100 subjects</span>
<span class="va">b0_urban</span> <span class="op">&lt;-</span> <span class="fl">450</span> <span class="co"># y-intercept</span>
<span class="va">b1_urban</span> <span class="op">&lt;-</span> <span class="fl">2</span>   <span class="co"># slope</span>

<span class="co"># decomposition table</span>
<span class="va">urban</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>
  subj_id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">n_subj</span>,
  group <span class="op">=</span> <span class="st">"urban"</span>,
  b0 <span class="op">=</span> <span class="fl">450</span>,
  b1 <span class="op">=</span> <span class="fl">2</span>,
  dist_level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="va">n_subj</span>, <span class="va">n_subj</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
  err <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n_subj</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">80</span><span class="op">)</span>,
  simple_rt <span class="op">=</span> <span class="va">b0</span> <span class="op">+</span> <span class="va">b1</span> <span class="op">*</span> <span class="va">dist_level</span> <span class="op">+</span> <span class="va">err</span><span class="op">)</span>

<span class="va">urban</span></code></pre></div>
<pre><code>## # A tibble: 100 × 7
##    subj_id group    b0    b1 dist_level     err simple_rt
##      &lt;int&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;      &lt;int&gt;   &lt;dbl&gt;     &lt;dbl&gt;
##  1       1 urban   450     2         59  -36.1       532.
##  2       2 urban   450     2         45  128.        668.
##  3       3 urban   450     2         55   23.5       584.
##  4       4 urban   450     2          8    1.04      467.
##  5       5 urban   450     2         47   48.7       593.
##  6       6 urban   450     2         96   88.2       730.
##  7       7 urban   450     2         62  110.        684.
##  8       8 urban   450     2          8  -91.6       374.
##  9       9 urban   450     2         15 -109.        371.
## 10      10 urban   450     2         70   20.7       611.
## # … with 90 more rows</code></pre>
<p>Let's plot the data we created, along with the line of best fit.</p>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span><span class="va">urban</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">dist_level</span>, <span class="va">simple_rt</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_point</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula 'y ~ x'</code></pre>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plot-urban"></span>
<img src="04-interactions_files/figure-html/plot-urban-1.png" alt="*Effect of sonic distraction on simple RT, urban group.*" width="100%"><p class="caption">
Figure 4.1: <em>Effect of sonic distraction on simple RT, urban group.</em>
</p>
</div>
<p>Now let's simulate data for the rural group. We assume that these participants should perhaps have a little higher intercept, maybe because they are less familiar with technology. Most importantly, we assume that they would have a steeper slope because they are more affected by the noise. Something like:</p>
<p><span class="math display">\[Y_i = 500 + 3 X_i + e_i\]</span></p>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">b0_rural</span> <span class="op">&lt;-</span> <span class="fl">500</span>
<span class="va">b1_rural</span> <span class="op">&lt;-</span> <span class="fl">3</span>

<span class="va">rural</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>
  subj_id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">n_subj</span> <span class="op">+</span> <span class="va">n_subj</span>,
  group <span class="op">=</span> <span class="st">"rural"</span>,
  b0 <span class="op">=</span> <span class="va">b0_rural</span>,
  b1 <span class="op">=</span> <span class="va">b1_rural</span>,
  dist_level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="va">n_subj</span>, <span class="va">n_subj</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
  err <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n_subj</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">80</span><span class="op">)</span>,
  simple_rt <span class="op">=</span> <span class="va">b0</span> <span class="op">+</span> <span class="va">b1</span> <span class="op">*</span> <span class="va">dist_level</span> <span class="op">+</span> <span class="va">err</span><span class="op">)</span></code></pre></div>
<p>Now let's plot the data from the two groups side by side.</p>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">all_data</span> <span class="op">&lt;-</span> <span class="fu">bind_rows</span><span class="op">(</span><span class="va">urban</span>, <span class="va">rural</span><span class="op">)</span>

<span class="fu">ggplot</span><span class="op">(</span><span class="va">all_data</span> <span class="op">%&gt;%</span> <span class="fu">mutate</span><span class="op">(</span>group <span class="op">=</span> <span class="fu">fct_relevel</span><span class="op">(</span><span class="va">group</span>, <span class="st">"urban"</span><span class="op">)</span><span class="op">)</span>, 
       <span class="fu">aes</span><span class="op">(</span><span class="va">dist_level</span>, <span class="va">simple_rt</span>, colour <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">group</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula 'y ~ x'</code></pre>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:combined-plot"></span>
<img src="04-interactions_files/figure-html/combined-plot-1.png" alt="*Effect of sonic distraction on simple RT for urban and rural participants.*" width="100%"><p class="caption">
Figure 4.2: <em>Effect of sonic distraction on simple RT for urban and rural participants.</em>
</p>
</div>
<p>Here we see very clearly the difference in slope that we built into our data. How do we test whether the two slopes are significantly different? To do this, we can't have two separate regressions. We need to bring the two regression lines into the same model. How do we do this?</p>
<p>Note that we can represent one of the regression lines in terms of 'offset' values from the other. We (arbitrarily) choose one group as our 'baseline' group, and represent the y-intercept and slope of the other group as offsets from this baseline. So if we choose the urban group as our baseline, we can express the y-intercept and slope for the rural group in terms of two offsets, <span class="math inline">\(\beta_2\)</span> and <span class="math inline">\(\beta_3\)</span>, for the y-intercept and slope, respectively.</p>
<ul>
<li>y-intercept: <span class="math inline">\(\beta_{0\_rural} = \beta_{0\_urban} + \beta_2\)</span>
</li>
<li>slope: <span class="math inline">\(\beta_{1\_rural} = \beta_{1\_urban} + \beta_3\)</span>
</li>
</ul>
<p>Our urban group had parameters <span class="math inline">\(\beta_{0\_urban} = 450\)</span> and <span class="math inline">\(\beta_{1\_urban} = 2\)</span>, whereas the rural group had <span class="math inline">\(\beta_{0\_rural} = 500\)</span> and <span class="math inline">\(\beta_{1\_rural} = 3\)</span>. It directly follows that:</p>
<ul>
<li>
<span class="math inline">\(\beta_2 = 50\)</span>, because <span class="math inline">\(\beta_{0\_rural} - \beta_{0\_urban} = 500 - 450 = 50\)</span>, and</li>
<li>
<span class="math inline">\(\beta_3 = 1\)</span>, because <span class="math inline">\(\beta_{1\_rural} - \beta_{1\_urban} = 3 - 2 = 1\)</span>.</li>
</ul>
<p>So our two regression models are now:</p>
<p><span class="math display">\[Y_{i\_urban} = \beta_{0\_urban} + \beta_{1\_urban} X_i + e_i\]</span></p>
<p>and</p>
<p><span class="math display">\[Y_{i\_rural} = (\beta_{0\_urban} + \beta_2) + (\beta_{1\_urban} + \beta_3) X_i + e_i.\]</span></p>
<p>OK, it seems like we're closer to getting these into a single regression model. Here's the final trick. We define an additional dummy predictor variable that takes on the value 0 for the urban group (which we chose as our 'baseline' group) and 1 for the other group. The box below contains our final model.</p>
<div class="info">
<p><strong>Regression model with a continuous-by-categorical interaction.</strong></p>
<p><span class="math display">\[Y_{i} = \beta_0 + \beta_1 X_{1i} + \beta_2 X_{2i} + \beta_3 X_{1i} X_{2i} + e_{i}\]</span></p>
<p>where</p>
<ul>
<li>
<span class="math inline">\(X_{1i}\)</span> is the continous predictor, and</li>
<li>
<span class="math inline">\(X_{2i}\)</span> is a dummy-coded variable taking on 0 for the baseline, 1 for the alternative group.</li>
</ul>
<p>Interpretation of parameters:</p>
<ul>
<li>
<span class="math inline">\(\beta_0\)</span>: y-intercept for the baseline group;</li>
<li>
<span class="math inline">\(\beta_1\)</span>: slope for the baseline group;</li>
<li>
<span class="math inline">\(\beta_2\)</span>: offset to y-intercept for the alternative group;</li>
<li>
<span class="math inline">\(\beta_3\)</span>: offset to slope for the alternative group.</li>
</ul>
<p>Estimation in R:</p>
<p><code><a href="https://rdrr.io/r/stats/lm.html">lm(Y ~ X1 + X2 + X1:X2, data)</a></code> or, as a shortcut:</p>
<p><code><a href="https://rdrr.io/r/stats/lm.html">lm(Y ~ X1 * X2)</a></code> where <code><a href="https://rdrr.io/r/base/Arithmetic.html">*</a></code> means "all possible main effects and interactions of X1 and X2"</p>
</div>
<p>The term <span class="math inline">\(\beta_3 X_{1i} X_{2i}\)</span>, which has the two predictors multiplied together, is called an <strong>interaction term</strong>. Let's now show that the above GLM gives us the two regression lines that we want.</p>
<p>To derive the regression equation for the urban group, we plug in 0 for <span class="math inline">\(X_{2i}\)</span>. This gives us</p>
<p><span class="math display">\[Y_{i} = \beta_0 + \beta_1 X_{1i} + \beta_2 0 + \beta_3 X_{1i} 0 + e_i\]</span></p>
<p>which, dropping terms that are zero, is just</p>
<p><span class="math display">\[Y_{i} = \beta_0 + \beta_1 X_{1i} + e_i,\]</span></p>
<p>which is the regression equation for our baseline (urban) group. Compare this to <span class="math inline">\(Y_{i\_urban}\)</span> above.</p>
<p>Plugging in 1 for <span class="math inline">\(X_{2i}\)</span> should give us the equation for our rural group. We get</p>
<p><span class="math display">\[Y_{i} = \beta_0 + \beta_1 X_{1i} + \beta_2 1 + \beta_3 X_{1i} 1 + e_i\]</span></p>
<p>which, after reducing and applying a little algebra, can also be expressed as</p>
<p><span class="math display">\[Y_{i} = \beta_0 + \beta_2 + (\beta_1 + \beta_3) X_{1i} + e_i.\]</span></p>
<p>Compare this to <span class="math inline">\(Y_{i\_rural}\)</span> above. The dummy-coding trick works!</p>
<p>How do we estimate the regression coefficients in R. Let's say we wanted to test the hypothesis that the slopes for the two lines are different. Note that this just amounts to testing the null hypothesis that <span class="math inline">\(\beta_3 = 0\)</span>, because <span class="math inline">\(\beta_3\)</span> is our slope offset. If this parameter is zero, that means there is a single slope for both groups (although they can have different intercepts). In other words, that means the two slopes are <strong>parallel</strong>. If it is non-zero, that means that the two groups have different slopes; that is, the two slopes are <strong>not parallel</strong>.</p>
<div class="warning">
<p><strong>Parallel lines in the sample versus in the population</strong></p>
<p>I just said that two non-parallel lines mean there is an <em>interaction</em> between the categorical and continuous predictors, and that parallel lines mean no interaction. It is important to be clear that I am talking about whether or not the lines are parallel in the <a class="glossary" target="_blank" title="All members of a group that we wish to generalise our findings to. E.g. all students taking Psychology at the University of Glasgow. We draw our testing sample from the population." href="https://psyteachr.github.io/glossary/p#population">population</a>. Whether or not they are parallel in the <a class="glossary" target="_blank" title="A subset of the population that you wish to make an inference about through your test." href="https://psyteachr.github.io/glossary/s#sample">sample</a> depends not only on their status in the population, but also on biases introduced by measurement and by sampling. Lines that are parallel in the population are nonetheless extremely likely to give rise to lines in the sample with slopes that appear different, especially if your sample is small.</p>
<p>Generally, you will be interested in whether the slopes are the same or different in the population, not in the sample. For this reason, you can't just look at a graph of sample data and reason, "the lines are not parallel and so there must be an interaction", or vice versa, "the lines look parallel, so there is no interaction." You must run an inferential statistical test.</p>
<p>When the interaction term is statistically significant at some <span class="math inline">\(\alpha\)</span> level (e.g., 0.05), you reject the null hypothesis that the interaction coefficient is zero (e.g., <span class="math inline">\(H_0: \beta_3 = 0\)</span>), which implies the lines are not parallel in the population.</p>
<p>However, a non-significant interaction does <em>not</em> necessarily imply that the lines are parallel in the population. They might be, but it's also possible that they are not, and your study just lacked sufficient <a class="glossary" target="_blank" title="The probability of rejecting the null hypothesis when it is false." href="https://psyteachr.github.io/glossary/p#power">power</a> to detect the difference.</p>
<p>The best you can do to get evidence for the null hypothesis is to run what is called an equivalence test, where you seek to reject a null hypothesis that the population effect is larger than some smallest effect size of interest; see <span class="citation">Lakens et al. (<a href="bibliography.html#ref-Lakens_Scheel_Isager_2018">2018</a>)</span> for a tutorial.</p>
</div>
<p>We have already created the dataset <code>all_data</code> combining the simulated data for our two groups. The way we express our model using R formula syntax is <code>Y ~ X1 + X2 + X1:X2</code> where <code>X1:X2</code> tells R to create a predictor that is the product of predictors X1 and X2. There is a shortcut <code>Y ~ X1 * X2</code> which tells R to calculate all possible main effects and interactions. First we'll add a dummy predictor to our model, storing the result in <code>all_data2</code>.</p>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">all_data2</span> <span class="op">&lt;-</span> <span class="va">all_data</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>grp <span class="op">=</span> <span class="fu">if_else</span><span class="op">(</span><span class="va">group</span> <span class="op">==</span> <span class="st">"rural"</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sonic_mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">simple_rt</span> <span class="op">~</span> <span class="va">dist_level</span> <span class="op">+</span> <span class="va">grp</span> <span class="op">+</span> <span class="va">dist_level</span><span class="op">:</span><span class="va">grp</span>,
                <span class="va">all_data2</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">sonic_mod</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = simple_rt ~ dist_level + grp + dist_level:grp, data = all_data2)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -261.130  -50.749    3.617   62.304  191.211 
## 
## Coefficients:
##                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    460.1098    15.5053  29.674  &lt; 2e-16 ***
## dist_level       1.9123     0.2620   7.299 7.07e-12 ***
## grp              4.8250    21.7184   0.222    0.824    
## dist_level:grp   1.5865     0.3809   4.166 4.65e-05 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 81.14 on 196 degrees of freedom
## Multiple R-squared:  0.5625, Adjusted R-squared:  0.5558 
## F-statistic: 83.99 on 3 and 196 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="try">
<p><strong>Exercises</strong></p>
<p>Fill in the blanks below. Type your answers to at least two decimal places.</p>
<p>Given the regression model</p>
<p><span class="math display">\[Y_{i} = \beta_0 + \beta_1 X_{1i} + \beta_2 X_{2i} + \beta_3 X_{1i} X_{2i} + e_{i}\]</span></p>
<p>(where <span class="math inline">\(X_{1i}\)</span> is the continuous predictor and <span class="math inline">\(X_{2i}\)</span> is the categorical predictor) and the output from <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> above, identify the following parameter estimates.</p>
<ul>
<li>
<span class="math inline">\(\hat{\beta}_0\)</span>: <input class="webex-solveme nospaces" data-tol="0.01" size="4" data-answer='["460.109764033163"]'>
</li>
<li>
<span class="math inline">\(\hat{\beta}_1\)</span>: <input class="webex-solveme nospaces" data-tol="0.01" size="4" data-answer='["1.91232184349596"]'>
</li>
<li>
<span class="math inline">\(\hat{\beta}_2\)</span>: <input class="webex-solveme nospaces" data-tol="0.01" size="4" data-answer='["4.82504807369759"]'>
</li>
<li>
<span class="math inline">\(\hat{\beta}_3\)</span>: <input class="webex-solveme nospaces" data-tol="0.01" size="4" data-answer='["1.58653315274424"]'>
</li>
</ul>
<p>Based on these parameter estimates, the regression line for the (baseline) urban group is:</p>
<p><span class="math inline">\(Y_i =\)</span> <input class="webex-solveme nospaces" data-tol="0.01" size="2" data-answer='["460.109764033163"]'><span class="math inline">\(+\)</span> <input class="webex-solveme nospaces" data-tol="0.01" size="2" data-answer='["1.91232184349596"]'><span class="math inline">\(X_{1i}\)</span></p>
<p>and the regression line for the rural group is:</p>
<p><span class="math inline">\(Y_i =\)</span> <input class="webex-solveme nospaces" data-tol="0.01" size="2" data-answer='["464.934812106861"]'><span class="math inline">\(+\)</span> <input class="webex-solveme nospaces" data-tol="0.01" size="2" data-answer='["3.4988549962402"]'><span class="math inline">\(X_{1i}\)</span></p>
<div class="webex-solution">
<button>
Show answers
</button>
<ul>
<li>
<span class="math inline">\(\beta_0=\)</span> 460.11</li>
<li>
<span class="math inline">\(\beta_1=\)</span> 1.91</li>
<li>
<span class="math inline">\(\beta_2=\)</span> 4.83</li>
<li>
<span class="math inline">\(\beta_3=\)</span> 1.59</li>
</ul>
<p>The regression line for the urban group is just</p>
<p><span class="math inline">\(Y_i = \beta_0 + \beta_1 X_{1i}\)</span> which is</p>
<p><span class="math inline">\(Y_i =\)</span> 460.11 <span class="math inline">\(+\)</span> 1.91 <span class="math inline">\(X_{1i}\)</span></p>
<p>while the line for the rural group is</p>
<p><span class="math inline">\(Y_i = \beta_0 + \beta_2 + \left(\beta_1 + \beta_3\right) X_{1i}\)</span> or</p>
<p><span class="math inline">\(Y_i=\)</span> 464.93 <span class="math inline">\(+\)</span> 3.5 <span class="math inline">\(X_{1i}\)</span></p>
</div>
</div>
</div>
<div id="categorical-by-categorical-interactions" class="section level2">
<h2>
<span class="header-section-number">4.2</span> Categorical-by-Categorical Interactions<a class="anchor" aria-label="anchor" href="#categorical-by-categorical-interactions"><i class="fas fa-link"></i></a>
</h2>
<p><strong>Factorial designs</strong> are very common in psychology, and are most often analyzed using ANOVA-based techniques, which can obscure the fact that ANOVA, like regression, also assumes an underlying linear model.</p>
<p>A factorial design is one in which the predictors (IVs) are all categorical: each is a <strong>factor</strong> having a fixed number of <strong>levels</strong>. In a full-factorial design, the factors are fully crossed with each other such that each possible combination of factors is represented. We call each unique combination a <strong>cell</strong> of the design. You will often hear designs referred to as "a two-by-two design" (2x2), which means that there are two factors, each of which has two levels. A "three-by-three" (3x3) design is one where there are two factors, each with three levels; a "two-by-two-by-two" 2x2x2 design is one in which there are three factors, each with two levels; and so on.</p>
<p>Typically, factorial designs are given a tabular representation, showing all the combinations of factor levels. Below is a tabular representation of a 2x2 design.</p>
<div class="inline-table"><table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
<span class="math inline">\(B_1\)</span>
</th>
<th style="text-align:left;">
<span class="math inline">\(B_2\)</span>
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
<span class="math inline">\(A_1\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(AB_{11}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(AB_{12}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(A_2\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(AB_{21}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(AB_{22}\)</span>
</td>
</tr>
</tbody>
</table></div>
<p>A 3x2 design might be shown as follows.</p>
<div class="inline-table"><table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
<span class="math inline">\(B_1\)</span>
</th>
<th style="text-align:left;">
<span class="math inline">\(B_2\)</span>
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
<span class="math inline">\(A_1\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(AB_{11}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(AB_{12}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(A_2\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(AB_{21}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(AB_{22}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(A_3\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(AB_{31}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(AB_{32}\)</span>
</td>
</tr>
</tbody>
</table></div>
<p>And finally, here's a 2x2x2 design.</p>
<p><span class="math display">\[C_1\]</span></p>
<div class="inline-table"><table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
<span class="math inline">\(B_1\)</span>
</th>
<th style="text-align:left;">
<span class="math inline">\(B_2\)</span>
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
<span class="math inline">\(A_1\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(ABC_{111}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(ABC_{121}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(A_2\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(ABC_{211}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(ABC_{221}\)</span>
</td>
</tr>
</tbody>
</table></div>
<p><span class="math display">\[C_2\]</span></p>
<div class="inline-table"><table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
<span class="math inline">\(B_1\)</span>
</th>
<th style="text-align:left;">
<span class="math inline">\(B_2\)</span>
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
<span class="math inline">\(A_1\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(ABC_{112}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(ABC_{122}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(A_2\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(ABC_{212}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(ABC_{222}\)</span>
</td>
</tr>
</tbody>
</table></div>
<div class="warning">
<p>Don't confuse <strong>factors</strong> and <strong>levels</strong>!</p>
<p>If you hear about a study that has three treatment groups (treatment A, treatment B, and control), that is not a "three-factor (three-way) design". That is a one-factor (one-way) design with a single three-level factor (treatment condition).</p>
<p>There is no such thing as a factor that has only one level.</p>
</div>
<p>You can find out how many cells a design has by multiplying the number of levels of each factor. So, a 2x3x4 design would have 24 cells in the design.</p>
<div id="effects-of-cognitive-therapy-and-drug-therapy-on-mood" class="section level3">
<h3>
<span class="header-section-number">4.2.1</span> Effects of cognitive therapy and drug therapy on mood<a class="anchor" aria-label="anchor" href="#effects-of-cognitive-therapy-and-drug-therapy-on-mood"><i class="fas fa-link"></i></a>
</h3>
<p>Let's consider a simple factorial design and think about the types of patterns our data can show. After we get the concepts down from this concrete example, we'll map them onto the more abstract statistical terminology.</p>
<p>Imagine you've running a study looking at effects of two different types of therapy for depressed patients, cognitive therapy and drug therapy. Half of the participants are randomly assigned to receive Cognitive Behavioral Therapy (CBT) and the other half get some other kind of control activity. Also, you further divide your patients through random assignment into a drug therapy group, whose members receive anti-depressants, and an control group, whose members receive a placebo. After treatment (or control/placebo), you measure their mood on a scale, with higher numbers corresponding to a more positive mood.</p>
<p>Let's imagine that the means we obtain below are the population means, free of measurement or sampling error. We'll take a moment to consider three different possible outcomes and what they imply about how these therapies might work independently or interactively to affect mood.</p>
<div class="warning">
<p>The reminder about populations and samples for categorical-by-continuous interactions also applies here. Except when simulating data, you will almost <strong>never</strong> know the true means of any population that you are studying. Below, we're talking about the hypothetical situation where you actually know the population means and can draw conclusions without any statistical tests. Any real sample means you look at will include sampling and measurement error, and any inferences you'd make would depend on the outcome of statistical tests, rather than the observed pattern of means.</p>
</div>
<div id="scenario-a" class="section level4 unnumbered">
<h4>Scenario A<a class="anchor" aria-label="anchor" href="#scenario-a"><i class="fas fa-link"></i></a>
</h4>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:scenario-a-plot"></span>
<img src="04-interactions_files/figure-html/scenario-a-plot-1.png" alt="*Scenario A, plot of cell means.*" width="50%"><p class="caption">
Figure 4.3: <em>Scenario A, plot of cell means.</em>
</p>
</div>
<p>Below is a table of <strong>cell means</strong> and <strong>marginal means</strong>. The cell means are the mean values of the dependent variable (mood) at each cell of the design. The marginal means (in the margins of the table) provide the means for each row and column.</p>
<div class="inline-table"><table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:scenario-a-means">Table 4.1: </span><em>Scenario A, Table of Means.</em>
</caption>
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
No CBT
</th>
<th style="text-align:right;">
CBT
</th>
<th style="text-align:left;">
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Placebo
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:left;">
50
</td>
</tr>
<tr>
<td style="text-align:left;">
Drug
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:right;">
80
</td>
<td style="text-align:left;">
70
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
70
</td>
<td style="text-align:left;">
</td>
</tr>
</tbody>
</table></div>
<p>If this was our outcome, what would you conclude? Is cognitive therapy having an effect on mood? How about drug therapy. The answer to both of these questions is yes: The mean mood for people who got CBT (70; mean of column 2) is 20 points higher than the mean mood for people who didn't (50; mean of column 1).</p>
<p>Likewise, people who got anti-depressants showed enhanced mood (70; mean of row 2) relative to people who got the placebo (50; mean of row 1).</p>
<p>Now we can also ask the following question: <strong>did the effect of cognitive therapy depend on whether or not the patient was simultaneously receiving drug therapy</strong>? The answer to this, is no. To see why, note that for the Placebo group (Row 1), cognitive therapy increased mood by 20 points (from 40 to 60). But this was the same for the Drug group: there was an increase of 20 points from 60 to 80. So, no evidence that the effect of one factor on mood depends on the other.</p>
</div>
<div id="scenario-b" class="section level4 unnumbered">
<h4>Scenario B<a class="anchor" aria-label="anchor" href="#scenario-b"><i class="fas fa-link"></i></a>
</h4>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:scenario-b-plot"></span>
<img src="04-interactions_files/figure-html/scenario-b-plot-1.png" alt="*Scenario B, plot of cell means.*" width="50%"><p class="caption">
Figure 4.4: <em>Scenario B, plot of cell means.</em>
</p>
</div>
<div class="inline-table"><table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:scenario-b-means">Table 4.2: </span><em>Scenario B, Table of Means.</em>
</caption>
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
No CBT
</th>
<th style="text-align:right;">
CBT
</th>
<th style="text-align:left;">
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Placebo
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:left;">
50
</td>
</tr>
<tr>
<td style="text-align:left;">
Drug
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:left;">
50
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:left;">
</td>
</tr>
</tbody>
</table></div>
<p>In this scenario, we also see that CBT improved mood (again, by 20 points), but there was no effect of Drug Therapy (equal marginal means of 50 for row 1 and row 2). We can also see here that the effect of CBT also didn't depend upon Drug therapy; there is an increase of 20 points in each row.</p>
</div>
<div id="scenario-c" class="section level4 unnumbered">
<h4>Scenario C<a class="anchor" aria-label="anchor" href="#scenario-c"><i class="fas fa-link"></i></a>
</h4>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:scenario-c-plot"></span>
<img src="04-interactions_files/figure-html/scenario-c-plot-1.png" alt="*Scenario C, plot of cell means.*" width="50%"><p class="caption">
Figure 4.5: <em>Scenario C, plot of cell means.</em>
</p>
</div>
<div class="inline-table"><table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:scenario-c-means">Table 4.3: </span><em>Scenario C, Table of Means.</em>
</caption>
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
No CBT
</th>
<th style="text-align:right;">
CBT
</th>
<th style="text-align:left;">
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Placebo
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:left;">
50
</td>
</tr>
<tr>
<td style="text-align:left;">
Drug
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
90
</td>
<td style="text-align:left;">
70
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
75
</td>
<td style="text-align:left;">
</td>
</tr>
</tbody>
</table></div>
<p>Following the logic in previous sections, we see that overall, people who got cognitive therapy showed elevated mood relative to control (75 vs 45), and that people who got drug therapy also showed elevated mood relative to placebo (70 vs 50). But there is something else going on here: it seems that the effect of cognitive therapy on mood was <strong>more pronounced for patients who were also receiving drug therapy</strong>. For patients on antidepressants, there was a 40 point increase in mood relative to control (from 50 to 90; row 2 of the table). For patients who got the placebo, there was only a 20 point increase in mood, from 40 to 60 (row 1 of the table). So in this hypothetical scenario, <strong>the effect of cognitive therapy depends on whether or not there is also ongoing drug therapy.</strong></p>
</div>
</div>
<div id="effects-in-a-factorial-design" class="section level3">
<h3>
<span class="header-section-number">4.2.2</span> Effects in a factorial design<a class="anchor" aria-label="anchor" href="#effects-in-a-factorial-design"><i class="fas fa-link"></i></a>
</h3>
<p>If you understand the basic patterns of effects described in the previous section, you are then ready to map these concepts onto statistical language.</p>
<div id="main-effect" class="section level4">
<h4>
<span class="header-section-number">4.2.2.1</span> Main effect<a class="anchor" aria-label="anchor" href="#main-effect"><i class="fas fa-link"></i></a>
</h4>
<p><strong>Main effect</strong>: The effect of a factor on the DV <strong>ignoring</strong> the other factors in the design.</p>
<p>The test of a main effect is a test of the equivalence of marginal means. So in Scenario A above, when you compared the row means for drug therapy, you were assessing the main effect of this factor on mood. The null hypothesis would be that the two marginal means are equal:</p>
<p><span class="math display">\[\bar{Y}_{1..} = \bar{Y}_{2..}\]</span></p>
<p>where <span class="math inline">\(Y_{i..}\)</span> is the mean of row <span class="math inline">\(i\)</span>, ignoring the column factor.</p>
<p>If you have a factor with <span class="math inline">\(k\)</span> levels where <span class="math inline">\(k &gt; 2\)</span>, the null hypothesis for the main effect is</p>
<p><span class="math display">\[\bar{Y}_{1..} = \bar{Y}_{2..} = \ldots = \bar{Y}_{k..},\]</span></p>
<p>i.e., that all of the row (or column) means are equal.</p>
</div>
<div id="simple-effect" class="section level4">
<h4>
<span class="header-section-number">4.2.2.2</span> Simple effect<a class="anchor" aria-label="anchor" href="#simple-effect"><i class="fas fa-link"></i></a>
</h4>
<p>A <strong>Simple effect</strong> is the effect of one factor at a specific level of another factor (i.e., holding that factor constant at a particular value).</p>
<p>So for instance, in Scenario C, we talked about the effect of CBT for participants in the anti-depressant group. In that case, the simple effect of CBT for participants receiving anti-depressants was 40 units.</p>
<p>We could also talk about the simple effect of drug therapy for patients who received cognitive therapy. In Scenario C, this was an increase in mood from 60 to 90 (column 2).</p>
</div>
<div id="interaction" class="section level4">
<h4>
<span class="header-section-number">4.2.2.3</span> Interaction<a class="anchor" aria-label="anchor" href="#interaction"><i class="fas fa-link"></i></a>
</h4>
<p>We say that an <strong>interaction</strong> is present when the effect of one variable differs across the levels of another variable.</p>
<p>A more mathematical definition is that an interaction is present when the simple effects of one factor differ across the levels of another factor. We saw this in Scenario C, with a 40 point boost of CBT for the anti-depressant group, compared to a boost of 20 for the placebo group. Perhaps the elevated mood caused by the anti-depressants made patients more susceptable to CBT.</p>
<p>The main point here is that we say there is a simple interaction between A and B when the simple effects of A differ across the levels of B. You could also check whether the simple effects of B differ across A. It is not possible for one of these statements to be true without the other also being true, so it doesn't matter which way you look at the simple effects.</p>
</div>
</div>
<div id="higher-order-designs" class="section level3">
<h3>
<span class="header-section-number">4.2.3</span> Higher-order designs<a class="anchor" aria-label="anchor" href="#higher-order-designs"><i class="fas fa-link"></i></a>
</h3>
<p>Two-factor (also known as "two-way") designs are very common in psychology and neuroscience, but sometimes you will also see designs with more than two factors, such as a 2x2x2 design.</p>
<p>To figure out the number of effects we have of different kinds, we use the formula below, which gives us the number of possible combinations for <span class="math inline">\(n\)</span> elements take <span class="math inline">\(k\)</span> at a time:</p>
<p><span class="math display">\[\frac{n!}{k!(n - k)!}\]</span></p>
<p>Rather than actually computing this by hand, we can just use the <code><a href="https://rdrr.io/r/base/Special.html">choose(n, k)</a></code> function in R.</p>
<p>For any design with <span class="math inline">\(n\)</span> factors, you will have:</p>
<ul>
<li>
<span class="math inline">\(n\)</span> main effects;</li>
<li>
<span class="math inline">\(\frac{n!}{2!(n - 2)!}\)</span> two-way interactions;</li>
<li>
<span class="math inline">\(\frac{n!}{3!(n - 3)!}\)</span> three-way interactions;</li>
<li>
<span class="math inline">\(\frac{n!}{4!(n - 4)!}\)</span> four-way interactions... and so forth.</li>
</ul>
<p>So if we have a three-way design, e.g., a 2x2x2 with factors <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span>, and <span class="math inline">\(C\)</span>, we would have 3 main effects: <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span>, and <span class="math inline">\(C\)</span>. We would have <code><a href="https://rdrr.io/r/base/Special.html">choose(3, 2)</a></code> = three two way interactions: <span class="math inline">\(AB\)</span>, <span class="math inline">\(AC\)</span>, and <span class="math inline">\(BC\)</span>, and <code><a href="https://rdrr.io/r/base/Special.html">choose(3, 3)</a></code> = one three-way interaction: <span class="math inline">\(ABC\)</span>.</p>
<p>Three-way interactions are hard to interpret, but what they imply is that the <strong>simple interaction</strong> between any two given factors varies across the level of the third factor. For example, it would imply that the <span class="math inline">\(AB\)</span> interaction at <span class="math inline">\(C_1\)</span> would be different from the <span class="math inline">\(AB\)</span> interaction at <span class="math inline">\(C_2\)</span>.</p>
<p>If you have a four way design, you have four main effects, <code>choose(4, 2) =</code>6 two-way interactions, <code>choose(4, 3) =</code>4 three-way interactions, and one four-way interaction. It is next to impossible to interpret results from a four-way design, so keep your designs simple!</p>
<!-- ## A common fallacy
Comparing the significance of the simple effects is **not the same** as testing whether the simple effects are significantly different.
-->
</div>
</div>
<div id="the-glm-for-a-factorial-design" class="section level2">
<h2>
<span class="header-section-number">4.3</span> The GLM for a factorial design<a class="anchor" aria-label="anchor" href="#the-glm-for-a-factorial-design"><i class="fas fa-link"></i></a>
</h2>
<p>Now let's look at the math behind these models. The typically way you'll see the GLM for an ANOVA written for a 2x2 factorial design uses "ANOVA" notation, like so:</p>
<p><span class="math display">\[Y_{ijk} = \mu + A_i + B_j + AB_{ij} + S(AB)_{ijk}.\]</span></p>
<p>In the above formula,</p>
<ul>
<li>
<span class="math inline">\(Y_{ijk}\)</span> is the score for observation <span class="math inline">\(k\)</span> at level <span class="math inline">\(i\)</span> of <span class="math inline">\(A\)</span> and level <span class="math inline">\(j\)</span> of <span class="math inline">\(B\)</span>;</li>
<li>
<span class="math inline">\(\mu\)</span> is the grand mean;</li>
<li>
<span class="math inline">\(A_i\)</span> is the main effect of factor <span class="math inline">\(A\)</span> at level <span class="math inline">\(i\)</span> of <span class="math inline">\(A\)</span>;</li>
<li>
<span class="math inline">\(B_j\)</span> is the main effect of factor <span class="math inline">\(B\)</span> at level <span class="math inline">\(j\)</span> of <span class="math inline">\(B\)</span>;</li>
<li>
<span class="math inline">\(AB_{ij}\)</span> is the <span class="math inline">\(AB\)</span> interaction at level <span class="math inline">\(i\)</span> of <span class="math inline">\(A\)</span> and level <span class="math inline">\(j\)</span> of <span class="math inline">\(B\)</span>;</li>
<li>
<span class="math inline">\(S(AB)_{ijk}\)</span> is the residual.</li>
</ul>
<p>An important mathematical fact is that the individual main and interaction effects sum to zero, often written as:</p>
<ul>
<li>
<span class="math inline">\(\Sigma_i A_i = 0\)</span>;</li>
<li>
<span class="math inline">\(\Sigma_j B_j = 0\)</span>;</li>
<li>
<span class="math inline">\(\Sigma_{ij} AB_{ij} = 0\)</span>.</li>
</ul>
<p>The best way to understand these effects is to see them in a decomposition table. Study the decomposition table belo wfor 12 simulated observations from a 2x2 design with factors <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>. The indexes <span class="math inline">\(i\)</span>, <span class="math inline">\(j\)</span>, and <span class="math inline">\(k\)</span> are provided just to help you keep track of what observation you are dealing with. Remember that <span class="math inline">\(i\)</span> indexes the level of factor <span class="math inline">\(A\)</span>, <span class="math inline">\(j\)</span> indexes the level of factor <span class="math inline">\(B\)</span>, and <span class="math inline">\(k\)</span> indexes the observation number within the cell <span class="math inline">\(AB_{ij}\)</span>.</p>
<pre><code>## # A tibble: 12 × 9
##        Y     i     j     k    mu   A_i   B_j AB_ij   err
##    &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;
##  1    11     1     1     1    10     4    -2    -1     0
##  2    14     1     1     2    10     4    -2    -1     3
##  3     8     1     1     3    10     4    -2    -1    -3
##  4    17     1     2     1    10     4     2     1     0
##  5    15     1     2     2    10     4     2     1    -2
##  6    19     1     2     3    10     4     2     1     2
##  7     8     2     1     1    10    -4    -2     1     3
##  8     4     2     1     2    10    -4    -2     1    -1
##  9     3     2     1     3    10    -4    -2     1    -2
## 10    10     2     2     1    10    -4     2    -1     3
## 11     7     2     2     2    10    -4     2    -1     0
## 12     4     2     2     3    10    -4     2    -1    -3</code></pre>
<div id="estimation-equations" class="section level3">
<h3>
<span class="header-section-number">4.3.1</span> Estimation equations<a class="anchor" aria-label="anchor" href="#estimation-equations"><i class="fas fa-link"></i></a>
</h3>
<p>These are the equations you would used to estimate effects in an ANOVA.</p>
<ul>
<li><span class="math inline">\(\hat{\mu} = Y_{...}\)</span></li>
<li><span class="math inline">\(\hat{A}_i = Y_{i..} - \hat{\mu}\)</span></li>
<li><span class="math inline">\(\hat{B}_j = Y_{.j.} - \hat{\mu}\)</span></li>
<li><span class="math inline">\(\widehat{AB}_{ij} = Y_{ij.} - \hat{\mu} - \hat{A}_i - \hat{B}_j\)</span></li>
</ul>
<p>Note that the <span class="math inline">\(Y\)</span> variable with the dots in the subscripts are means of <span class="math inline">\(Y\)</span>, taken while ignoring anything appearing as a dot. So <span class="math inline">\(Y_{...}\)</span> is mean of <span class="math inline">\(Y\)</span>, <span class="math inline">\(Y_{i..}\)</span> is the mean of <span class="math inline">\(Y\)</span> at level <span class="math inline">\(i\)</span> of <span class="math inline">\(A\)</span>, <span class="math inline">\(Y_{.j.}\)</span> is the mean of <span class="math inline">\(Y\)</span> at level <span class="math inline">\(j\)</span> of <span class="math inline">\(B\)</span>, and <span class="math inline">\(Y_{ij.}\)</span> is the mean of <span class="math inline">\(Y\)</span> at level <span class="math inline">\(i\)</span> of <span class="math inline">\(A\)</span> and level <span class="math inline">\(j\)</span> of <span class="math inline">\(B\)</span>, i.e., the cell mean <span class="math inline">\(ij\)</span>.</p>
</div>
<div id="factorial-app" class="section level3">
<h3>
<span class="header-section-number">4.3.2</span> Factorial App<a class="anchor" aria-label="anchor" href="#factorial-app"><i class="fas fa-link"></i></a>
</h3>
<div class="inline-figure"><img src="images/04-interactions_factorial_app.png"></div>
<p><a href="https://shiny.psy.gla.ac.uk/Dale/factorial2" target="_blank">Launch this web application</a> and experiment with factorial designs until you understand the key concepts of main effects and interactions in a factorial design.</p>
</div>
</div>
<div id="code-your-own-categorical-predictors-in-factorial-designs" class="section level2">
<h2>
<span class="header-section-number">4.4</span> Code your own categorical predictors in factorial designs<a class="anchor" aria-label="anchor" href="#code-your-own-categorical-predictors-in-factorial-designs"><i class="fas fa-link"></i></a>
</h2>
<p>Many studies in psychology---especially experimental psychology---involve categorical independent variables. Analyzing data from these studies requires care in specifying the predictors, because the defaults in R are not ideal for experimental situations. The main problem is that the default coding of categorical predictors gives you <strong>simple effects</strong> rather than <strong>main effects</strong> in the output, when what you usually want are the latter. People are sometimes unaware of this and misinterpret their output. It also happens that researchers report results from a regression with categorical predictors but do not explicitly report how they coded them, making their findings potentially difficult to interpret and irreproducible. In the interest of reproducibility, transparency, and accurate interpretation, it is a good idea to learn how to code categorical predictors "by hand" and to get into the habit of reporting them in your reports.</p>
<p>Because the R defaults aren't good for factorial designs, I'm going to suggest that you should always code your own categorical variables when including them as predictors in linear models. Don't include them as <code>factor</code> variables.</p>
</div>
<div id="coding-schemes-for-categorical-variables" class="section level2">
<h2>
<span class="header-section-number">4.5</span> Coding schemes for categorical variables<a class="anchor" aria-label="anchor" href="#coding-schemes-for-categorical-variables"><i class="fas fa-link"></i></a>
</h2>
<p>Many experimentalists who are trying to make the leap from ANOVA to linear mixed-effects models (LMEMs) in R struggle with the coding of categorical predictors. It is unexpectedly complicated, and the defaults provided in R turn out to be wholly inappropriate for factorial experiments. Indeed, using those defaults with factorial experiments can lead researchers to draw erroneous conclusions from their data.</p>
<p>To keep things simple, we'll start with situations where design factors have no more than two levels before moving on to designs with more than three levels.</p>
<div id="simple-versus-main-effects" class="section level3">
<h3>
<span class="header-section-number">4.5.1</span> Simple versus main effects<a class="anchor" aria-label="anchor" href="#simple-versus-main-effects"><i class="fas fa-link"></i></a>
</h3>
<p>It is important that you understand the difference between a <strong>simple effect</strong> and a <strong>main effect</strong>, and between a <strong>simple interaction</strong> and a <strong>main interaction</strong> in a three-way design.</p>
<p>In an <span class="math inline">\(A{\times}B\)</span> design, the simple effect of <span class="math inline">\(A\)</span> is the effect of <span class="math inline">\(A\)</span> <strong>controlling</strong> for <span class="math inline">\(B\)</span>, while the main effect of <span class="math inline">\(A\)</span> is the effect of <span class="math inline">\(A\)</span> <strong>ignoring</strong> <span class="math inline">\(B\)</span>. Another way of looking at this is to consider the cell means (<span class="math inline">\(\bar{Y}_{11}\)</span>, <span class="math inline">\(\bar{Y}_{12}\)</span>, <span class="math inline">\(\bar{Y}_{21}\)</span>, and <span class="math inline">\(\bar{Y}_{22}\)</span>) and marginal means (<span class="math inline">\(\bar{Y}_{1.}\)</span>, <span class="math inline">\(\bar{Y}_{2.}\)</span>, <span class="math inline">\(\bar{Y}_{.1}\)</span>, and <span class="math inline">\(\bar{Y}_{.2}\)</span>) in a factorial design. (The dot subscript tells you to "ignore" the dimension containing the dot; e.g., <span class="math inline">\(\bar{Y}_{.1}\)</span> tells you to take the mean of the first column ignoring the row variable.) To test the main effect of A is to test the null hypothesis that <span class="math inline">\(\bar{Y}_{1.}=\bar{Y}_{2.}\)</span>. To test a simple effect of <span class="math inline">\(A\)</span>—the effect of <span class="math inline">\(A\)</span> at a particular level of <span class="math inline">\(B\)</span>—would be, for instance, to test the null hypothesis that <span class="math inline">\(\bar{Y}_{11}=\bar{Y}_{21}\)</span>.</p>
<div class="inline-table"><table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:center;">
</th>
<th style="text-align:center;">
<span class="math inline">\(B_1\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(B_2\)</span>
</th>
<th style="text-align:center;">
</th>
<th style="text-align:center;">
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
<span class="math inline">\(A_1\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{11}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{12}\)</span>
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{1.}\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">\(A_2\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{21}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{22}\)</span>
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{2.}\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{.1}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{.2}\)</span>
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
</tr>
</tbody>
</table></div>
<p>The distinction between <strong>simple interactions</strong> and <strong>main interactions</strong> has the same logic: the simple interaction of <span class="math inline">\(AB\)</span> in an <span class="math inline">\(ABC\)</span> design is the interaction of <span class="math inline">\(AB\)</span> at a particular level of <span class="math inline">\(C\)</span>; the main interaction of <span class="math inline">\(AB\)</span> is the interaction <strong>ignoring</strong> C. The latter is what we are usually talking about when we talk about lower-order interactions in a three-way design. It is also what we are given in the output from standard ANOVA procedures, e.g., the <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code> function in R, SPSS, SAS, etc.</p>
</div>
<div id="the-key-coding-schemes" class="section level3">
<h3>
<span class="header-section-number">4.5.2</span> The key coding schemes<a class="anchor" aria-label="anchor" href="#the-key-coding-schemes"><i class="fas fa-link"></i></a>
</h3>
<p>Generally, the choice of a coding scheme impacts the interpretation of:</p>
<ol style="list-style-type: decimal">
<li>the intercept term; and</li>
<li>the interpretation of the tests for all but the highest-order effects and interactions in a factorial design.</li>
</ol>
<p>It also can influence the interpretation/estimation of random effects in a mixed-effects model (see <a href="https://talklab.psy.gla.ac.uk/simgen/rsonly.html">this blog post</a> for further discussion). If you have a design with only a single two-level factor, and are using a <a href="https://www.sciencedirect.com/science/article/pii/S0749596X12001180">maximal random-effects structure</a>, the choice of coding scheme doesn't really matter.</p>
<p>There are many possible coding schemes (see <code><a href="https://rdrr.io/r/stats/contrast.html">?contr.treatment</a></code> for more information). The most relevant ones are <strong>treatment</strong>, <strong>sum</strong>, and <strong>deviation</strong>. Sum and deviation coding can be seen as special cases of <strong>effect</strong> coding; by effect coding, people generally mean codes that sum to zero.</p>
<p>For a two-level factor, you would use the following codes:</p>
<div class="inline-table"><table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
Scheme
</th>
<th style="text-align:right;">
<span class="math inline">\(A_1\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(A_2\)</span>
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Treatment (dummy)
</td>
<td style="text-align:right;">
<span class="math inline">\(0\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(1\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Sum
</td>
<td style="text-align:right;">
<span class="math inline">\(-1\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(1\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Deviation
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{2}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(\frac{1}{2}\)</span>
</td>
</tr>
</tbody>
</table></div>
<dl>
<dt>The default in R is to use treatment coding for any variable defined as a =factor= in the model (see <code><a href="https://rdrr.io/r/base/factor.html">?factor</a></code> and <code><a href="https://rdrr.io/r/stats/contrasts.html">?contrasts</a></code> for information). To see why this is not ideal for factorial designs, consider a 2x2x2 factorial design with factors <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span> and <span class="math inline">\(C\)</span>. We will just consider a fully between-subjects design with only one observation per subject as this allows us to use the simplest possible error structure. We would fit such a model using <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>:</dt>
<dd>
<p>lm(Y ~ A * B * C)</p>
</dd>
</dl>
<p>The figure below spells out the notation for the various cell and marginal means for a 2x2x2 design.</p>
<p><span class="math display">\[C_1\]</span></p>
<div class="inline-table"><table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:center;">
</th>
<th style="text-align:center;">
<span class="math inline">\(B_1\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(B_2\)</span>
</th>
<th style="text-align:center;">
</th>
<th style="text-align:center;">
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
<span class="math inline">\(A_1\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{111}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{121}\)</span>
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{1.1}\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">\(A_2\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{211}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{221}\)</span>
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{2.1}\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{.11}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{.21}\)</span>
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
</tr>
</tbody>
</table></div>
<p><span class="math display">\[C_2\]</span></p>
<div class="inline-table"><table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:center;">
</th>
<th style="text-align:center;">
<span class="math inline">\(B_1\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(B_2\)</span>
</th>
<th style="text-align:center;">
</th>
<th style="text-align:center;">
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
<span class="math inline">\(A_1\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{112}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{122}\)</span>
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{1.2}\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">\(A_2\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{212}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{222}\)</span>
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{2.2}\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{.12}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{.22}\)</span>
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
</tr>
</tbody>
</table></div>
<p>The table below provides the interpretation for various effects in the model under the three different coding schemes. Note that <span class="math inline">\(Y\)</span> is the dependent variable, and the dots in the subscript mean to "ignore" the corresponding dimension. Thus, <span class="math inline">\(\bar{Y}_{.1.}\)</span> is the mean of B_1 (ignoring factors <span class="math inline">\(A\)</span> and <span class="math inline">\(C\)</span>) and <span class="math inline">\(\bar{Y}_{...}\)</span> is the "grand mean" (ignoring all factors).</p>
<div class="inline-table"><table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:center;">
term
</th>
<th style="text-align:center;">
treatment
</th>
<th style="text-align:center;">
sum
</th>
<th style="text-align:center;">
deviation
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
<span class="math inline">\(\mu\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{111}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{...}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{...}\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">\(A\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{211} - \bar{Y}_{111}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\frac{(\bar{Y}_{2..} - \bar{Y}_{1..})}{2}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{2..} - \bar{Y}_{1..}\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">\(B\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{121} - \bar{Y}_{111}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\frac{(\bar{Y}_{.2.} - \bar{Y}_{.1.})}{2}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{.2.} - \bar{Y}_{.1.}\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">\(C\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{112} - \bar{Y}_{111}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\frac{(\bar{Y}_{..2} - \bar{Y}_{..1})}{2}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{..2} - \bar{Y}_{..1}\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">\(AB\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\((\bar{Y}_{221} - \bar{Y}_{121}) - (\bar{Y}_{211} - \bar{Y}_{111})\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\frac{(\bar{Y}_{22.} - \bar{Y}_{12.}) - (\bar{Y}_{21.} - \bar{Y}_{11.})}{4}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\((\bar{Y}_{22.} - \bar{Y}_{12.}) - (\bar{Y}_{21.} - \bar{Y}_{11.})\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">\(AC\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\((\bar{Y}_{212} - \bar{Y}_{211}) - (\bar{Y}_{112} - \bar{Y}_{111})\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\frac{(\bar{Y}_{2.2} - \bar{Y}_{1.2}) - (\bar{Y}_{2.1} - \bar{Y}_{1.1})}{4}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\((\bar{Y}_{2.2} - \bar{Y}_{1.2}) - (\bar{Y}_{2.1} - \bar{Y}_{1.1})\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">\(BC\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\((\bar{Y}_{122} - \bar{Y}_{112}) - (\bar{Y}_{121} - \bar{Y}_{111})\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\frac{(\bar{Y}_{.22} - \bar{Y}_{.12}) - (\bar{Y}_{.21} - \bar{Y}_{.11})}{4}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\((\bar{Y}_{.22} - \bar{Y}_{.12}) - (\bar{Y}_{.21} - \bar{Y}_{.11})\)</span>
</td>
</tr>
</tbody>
</table></div>
<p>For the three way <span class="math inline">\(A \times B \times C\)</span> interaction:</p>
<div class="inline-table"><table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:center;">
scheme
</th>
<th style="text-align:center;">
interpretation
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
treatment
</td>
<td style="text-align:center;">
<span class="math inline">\(\displaystyle\left[\displaystyle\left(\bar{Y}_{221} - \bar{Y}_{121}\right) - \displaystyle\left(\bar{Y}_{211} - \bar{Y}_{111}\right)\right] - \displaystyle\left[\displaystyle\left(\bar{Y}_{222} - \bar{Y}_{122}\right) - \displaystyle\left(\bar{Y}_{212} - \bar{Y}_{112}\right)\right]\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
sum
</td>
<td style="text-align:center;">
<span class="math inline">\(\frac{\displaystyle\left[\displaystyle\left(\bar{Y}_{221} - \bar{Y}_{121}\right) - \displaystyle\left(\bar{Y}_{211} - \bar{Y}_{111}\right)\right] - \displaystyle\left[\displaystyle\left(\bar{Y}_{222} - \bar{Y}_{122}\right) - \displaystyle\left(\bar{Y}_{212} - \bar{Y}_{112}\right)\right]}{8}\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
deviation
</td>
<td style="text-align:center;">
<span class="math inline">\(\displaystyle\left[\displaystyle\left(\bar{Y}_{221} - \bar{Y}_{121}\right) - \displaystyle\left(\bar{Y}_{211} - \bar{Y}_{111}\right)\right] - \displaystyle\left[\displaystyle\left(\bar{Y}_{222} - \bar{Y}_{122}\right) - \displaystyle\left(\bar{Y}_{212} - \bar{Y}_{112}\right)\right]\)</span>
</td>
</tr>
</tbody>
</table></div>
<p>Note that the inferential tests of <span class="math inline">\(A \times B \times C\)</span> will all have the same outcome, despite the parameter estimate for sum coding being one-eighth of that for the other schemes. For all lower-order effects, sum and deviation coding will give different parameter estimates but identical inferential outcomes. Both of these schemes provide identical tests of the canonical main effects and main interactions for a three-way ANOVA. In contrast, treatment (dummy) coding will provide inferential tests of simple effects and simple interactions. So, if what you are interested in getting are the "canonical" tests from ANOVA, use sum or deviation coding.</p>
</div>
<div id="what-about-factors-with-more-than-two-levels" class="section level3">
<h3>
<span class="header-section-number">4.5.3</span> What about factors with more than two levels?<a class="anchor" aria-label="anchor" href="#what-about-factors-with-more-than-two-levels"><i class="fas fa-link"></i></a>
</h3>
<p>A factor with <span class="math inline">\(k\)</span> levels requires <span class="math inline">\(k-1\)</span> variables. Each predictor contrasts a particular "target" level of the factor with a level that you (arbitrarily) choose as the "baseline" level. For instance, for a three-level factor <span class="math inline">\(A\)</span> with <span class="math inline">\(A1\)</span> chosen as the baseline, you'd have two predictor variables, one of which compares <span class="math inline">\(A2\)</span> to <span class="math inline">\(A1\)</span> and the other of which compares <span class="math inline">\(A3\)</span> to <span class="math inline">\(A1\)</span>.</p>
<p>For treatment (dummy) coding, the target level is set to 1, otherwise 0.</p>
<p>For sum coding, the levels must sum to zero, so for a given predictor, the target level is given the value 1, the baseline level is given the value -1, and any other level is given the value 0.</p>
<p>For deviation coding, the values must also sum to 0. Deviation coding is recommended whenever you are trying to draw ANOVA-style inferences. Under this scheme, the target level gets the value <span class="math inline">\(\frac{k-1}{k}\)</span> while any non-target level gets the value <span class="math inline">\(-\frac{1}{k}\)</span>.</p>
<p><strong>Fun fact</strong>: Mean-centering treatment codes (on balanced data) will give you deviation codes.</p>
</div>
<div id="example-three-level-factor" class="section level3">
<h3>
<span class="header-section-number">4.5.4</span> Example: Three-level factor<a class="anchor" aria-label="anchor" href="#example-three-level-factor"><i class="fas fa-link"></i></a>
</h3>
<div id="treatment-dummy" class="section level4">
<h4>
<span class="header-section-number">4.5.4.1</span> Treatment (Dummy)<a class="anchor" aria-label="anchor" href="#treatment-dummy"><i class="fas fa-link"></i></a>
</h4>
<div class="inline-table"><table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
level
</th>
<th style="text-align:right;">
A2v1
</th>
<th style="text-align:right;">
A3v1
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
A1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
A2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
A3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table></div>
</div>
<div id="sum" class="section level4">
<h4>
<span class="header-section-number">4.5.4.2</span> Sum<a class="anchor" aria-label="anchor" href="#sum"><i class="fas fa-link"></i></a>
</h4>
<div class="inline-table"><table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
level
</th>
<th style="text-align:right;">
A2v1
</th>
<th style="text-align:right;">
A3v1
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
A1
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:right;">
-1
</td>
</tr>
<tr>
<td style="text-align:left;">
A2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
A3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table></div>
</div>
<div id="deviation" class="section level4">
<h4>
<span class="header-section-number">4.5.4.3</span> Deviation<a class="anchor" aria-label="anchor" href="#deviation"><i class="fas fa-link"></i></a>
</h4>
<div class="inline-table"><table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
level
</th>
<th style="text-align:right;">
A2v1
</th>
<th style="text-align:right;">
A3v1
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
A1
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{3}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{3}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
A2
</td>
<td style="text-align:right;">
<span class="math inline">\(\frac{2}{3}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{3}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
A3
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{3}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(\frac{2}{3}\)</span>
</td>
</tr>
</tbody>
</table></div>
</div>
<div id="example-five-level-factor" class="section level4">
<h4>
<span class="header-section-number">4.5.4.4</span> Example: Five-level factor<a class="anchor" aria-label="anchor" href="#example-five-level-factor"><i class="fas fa-link"></i></a>
</h4>
</div>
<div id="treatment-dummy-1" class="section level4">
<h4>
<span class="header-section-number">4.5.4.5</span> Treatment (Dummy)<a class="anchor" aria-label="anchor" href="#treatment-dummy-1"><i class="fas fa-link"></i></a>
</h4>
<div class="inline-table"><table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
level
</th>
<th style="text-align:right;">
A2v1
</th>
<th style="text-align:right;">
A3v1
</th>
<th style="text-align:right;">
A4v1
</th>
<th style="text-align:right;">
A5v1
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
A1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
A2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
A3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
A4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
A5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table></div>
</div>
<div id="sum-1" class="section level4">
<h4>
<span class="header-section-number">4.5.4.6</span> Sum<a class="anchor" aria-label="anchor" href="#sum-1"><i class="fas fa-link"></i></a>
</h4>
<div class="inline-table"><table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
level
</th>
<th style="text-align:right;">
A2v1
</th>
<th style="text-align:right;">
A3v1
</th>
<th style="text-align:right;">
A4v1
</th>
<th style="text-align:right;">
A5v1
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
A1
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:right;">
-1
</td>
</tr>
<tr>
<td style="text-align:left;">
A2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
A3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
A4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
A5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table></div>
</div>
<div id="deviation-1" class="section level4">
<h4>
<span class="header-section-number">4.5.4.7</span> Deviation<a class="anchor" aria-label="anchor" href="#deviation-1"><i class="fas fa-link"></i></a>
</h4>
<div class="inline-table"><table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
level
</th>
<th style="text-align:right;">
A2v1
</th>
<th style="text-align:right;">
A3v1
</th>
<th style="text-align:right;">
A4v1
</th>
<th style="text-align:right;">
A5v1
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
A1
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{5}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{5}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{5}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{5}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
A2
</td>
<td style="text-align:right;">
<span class="math inline">\(\frac{4}{5}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{5}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{5}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{5}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
A3
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{5}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(\frac{4}{5}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{5}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{5}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
A4
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{5}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{5}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(\frac{4}{5}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{5}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
A5
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{5}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{5}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{5}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(\frac{4}{5}\)</span>
</td>
</tr>
</tbody>
</table></div>
</div>
</div>
<div id="how-to-create-your-own-numeric-predictors" class="section level3">
<h3>
<span class="header-section-number">4.5.5</span> How to create your own numeric predictors<a class="anchor" aria-label="anchor" href="#how-to-create-your-own-numeric-predictors"><i class="fas fa-link"></i></a>
</h3>
<p>Let's assume that your data is contained in a table <code>dat</code> like the one below.</p>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r">
<code class="sourceCode R"> <span class="co">## create your own numeric predictors</span>
 <span class="co">## make an example table</span>
 <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>Y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">12</span><span class="op">)</span>,
               A <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="webex-solution">
<button>
Click to view example data
</button>
<div class="inline-table"><table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:right;">
Y
</th>
<th style="text-align:left;">
A
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
-0.41
</td>
<td style="text-align:left;">
A1
</td>
</tr>
<tr>
<td style="text-align:right;">
-1.44
</td>
<td style="text-align:left;">
A1
</td>
</tr>
<tr>
<td style="text-align:right;">
-2.01
</td>
<td style="text-align:left;">
A1
</td>
</tr>
<tr>
<td style="text-align:right;">
0.56
</td>
<td style="text-align:left;">
A1
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.67
</td>
<td style="text-align:left;">
A2
</td>
</tr>
<tr>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:left;">
A2
</td>
</tr>
<tr>
<td style="text-align:right;">
-1.61
</td>
<td style="text-align:left;">
A2
</td>
</tr>
<tr>
<td style="text-align:right;">
0.32
</td>
<td style="text-align:left;">
A2
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.44
</td>
<td style="text-align:left;">
A3
</td>
</tr>
<tr>
<td style="text-align:right;">
1.19
</td>
<td style="text-align:left;">
A3
</td>
</tr>
<tr>
<td style="text-align:right;">
0.87
</td>
<td style="text-align:left;">
A3
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.50
</td>
<td style="text-align:left;">
A3
</td>
</tr>
</tbody>
</table></div>
</div>
<div id="the-mutate-if_else-case_when-approach-for-a-three-level-factor" class="section level4">
<h4>
<span class="header-section-number">4.5.5.1</span> The <code>mutate()</code> / <code>if_else()</code> / <code>case_when()</code> approach for a three-level factor<a class="anchor" aria-label="anchor" href="#the-mutate-if_else-case_when-approach-for-a-three-level-factor"><i class="fas fa-link"></i></a>
</h4>
</div>
<div id="treatment" class="section level4">
<h4>
<span class="header-section-number">4.5.5.2</span> Treatment<a class="anchor" aria-label="anchor" href="#treatment"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="co">## examples of three level factors</span>
  <span class="co">## treatment coding</span>
  <span class="va">dat_treat</span> <span class="op">&lt;-</span> <span class="va">dat</span> <span class="op">%&gt;%</span>
    <span class="fu">mutate</span><span class="op">(</span>A2v1 <span class="op">=</span> <span class="fu">if_else</span><span class="op">(</span><span class="va">A</span> <span class="op">==</span> <span class="st">"A2"</span>, <span class="fl">1L</span>, <span class="fl">0L</span><span class="op">)</span>,
       A3v1 <span class="op">=</span> <span class="fu">if_else</span><span class="op">(</span><span class="va">A</span> <span class="op">==</span> <span class="st">"A3"</span>, <span class="fl">1L</span>, <span class="fl">0L</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="webex-solution">
<button>
Click to view resulting table
</button>
<pre><code>## # A tibble: 12 × 4
##         Y A      A2v1  A3v1
##     &lt;dbl&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt;
##  1 -0.410 A1        0     0
##  2 -1.44  A1        0     0
##  3 -2.01  A1        0     0
##  4  0.562 A1        0     0
##  5 -0.671 A2        1     0
##  6  1.00  A2        1     0
##  7 -1.61  A2        1     0
##  8  0.322 A2        1     0
##  9 -0.443 A3        0     1
## 10  1.19  A3        0     1
## 11  0.868 A3        0     1
## 12 -0.500 A3        0     1</code></pre>
</div>
</div>
<div id="sum-2" class="section level4">
<h4>
<span class="header-section-number">4.5.5.3</span> Sum<a class="anchor" aria-label="anchor" href="#sum-2"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## sum coding</span>
<span class="va">dat_sum</span> <span class="op">&lt;-</span> <span class="va">dat</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>A2v1 <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span><span class="va">A</span> <span class="op">==</span> <span class="st">"A1"</span> <span class="op">~</span> <span class="op">-</span><span class="fl">1L</span>, <span class="co"># baseline</span>
                          <span class="va">A</span> <span class="op">==</span> <span class="st">"A2"</span> <span class="op">~</span> <span class="fl">1L</span>,  <span class="co"># target</span>
                          <span class="cn">TRUE</span>      <span class="op">~</span> <span class="fl">0L</span><span class="op">)</span>, <span class="co"># anything else</span>
         A3v1 <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span><span class="va">A</span> <span class="op">==</span> <span class="st">"A1"</span> <span class="op">~</span> <span class="op">-</span><span class="fl">1L</span>, <span class="co"># baseline</span>
                          <span class="va">A</span> <span class="op">==</span> <span class="st">"A3"</span> <span class="op">~</span>  <span class="fl">1L</span>, <span class="co"># target</span>
                          <span class="cn">TRUE</span>      <span class="op">~</span> <span class="fl">0L</span><span class="op">)</span><span class="op">)</span> <span class="co"># anything else</span></code></pre></div>
<div class="webex-solution">
<button>
Click to view resulting table
</button>
<pre><code>## # A tibble: 12 × 4
##         Y A      A2v1  A3v1
##     &lt;dbl&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt;
##  1 -0.410 A1       -1    -1
##  2 -1.44  A1       -1    -1
##  3 -2.01  A1       -1    -1
##  4  0.562 A1       -1    -1
##  5 -0.671 A2        1     0
##  6  1.00  A2        1     0
##  7 -1.61  A2        1     0
##  8  0.322 A2        1     0
##  9 -0.443 A3        0     1
## 10  1.19  A3        0     1
## 11  0.868 A3        0     1
## 12 -0.500 A3        0     1</code></pre>
</div>
</div>
<div id="deviation-2" class="section level4">
<h4>
<span class="header-section-number">4.5.5.4</span> Deviation<a class="anchor" aria-label="anchor" href="#deviation-2"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb114"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## deviation coding</span>
<span class="co">## baseline A1</span>
<span class="va">dat_dev</span> <span class="op">&lt;-</span> <span class="va">dat</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>A2v1 <span class="op">=</span> <span class="fu">if_else</span><span class="op">(</span><span class="va">A</span> <span class="op">==</span> <span class="st">"A2"</span>, <span class="fl">2</span><span class="op">/</span><span class="fl">3</span>, <span class="op">-</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span>, <span class="co"># target A2</span>
         A3v1 <span class="op">=</span> <span class="fu">if_else</span><span class="op">(</span><span class="va">A</span> <span class="op">==</span> <span class="st">"A3"</span>, <span class="fl">2</span><span class="op">/</span><span class="fl">3</span>, <span class="op">-</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="co"># target A3</span></code></pre></div>
<div class="webex-solution">
<button>
Click to view resulting table
</button>
<div class="sourceCode" id="cb115"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat_dev</span></code></pre></div>
<pre><code>## # A tibble: 12 × 4
##         Y A       A2v1   A3v1
##     &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt;
##  1 -0.410 A1    -0.333 -0.333
##  2 -1.44  A1    -0.333 -0.333
##  3 -2.01  A1    -0.333 -0.333
##  4  0.562 A1    -0.333 -0.333
##  5 -0.671 A2     0.667 -0.333
##  6  1.00  A2     0.667 -0.333
##  7 -1.61  A2     0.667 -0.333
##  8  0.322 A2     0.667 -0.333
##  9 -0.443 A3    -0.333  0.667
## 10  1.19  A3    -0.333  0.667
## 11  0.868 A3    -0.333  0.667
## 12 -0.500 A3    -0.333  0.667</code></pre>
</div>
</div>
</div>
<div id="conclusion" class="section level3">
<h3>
<span class="header-section-number">4.5.6</span> Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"><i class="fas fa-link"></i></a>
</h3>
<p><strong>The interpretation of all but the highest order effect depends on the coding scheme.</strong></p>
<p>With treatment coding, you are looking at <strong>simple</strong> effects and <strong>simple</strong> interactions, not <strong>main</strong> effects and <strong>main</strong> interactions.</p>
<p><strong>The parameter estimates for sum coding differs from deviation coding only in the magnitude of the parameter estimates, but have identical interpretations.</strong></p>
<p>Because it is not subject to the scaling effects seen under sum coding, deviation should be used by default for ANOVA-style designs.</p>
<p><strong>The default coding scheme for factors is R is "treatment" coding.</strong></p>
<p>So, anytime you declare a variable as type <code>factor</code> and use this variable as a predictor in your regression model, R will automatically create treatment-coded variables.</p>
<div class="warning">
<p><strong>Take-home message: when analyzing factorial designs in R using regression, to obtain the canonical ANOVA-style interpretations of main effects and interactions use deviation coding and NOT the default treatment coding.</strong></p>
</div>

</div>
</div>
</div>
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  if (t = document.getElementById("webex-total_correct")) {
    t.innerHTML =
      document.getElementsByClassName("webex-correct").length + " of " +
      document.getElementsByClassName("webex-solveme").length + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

window.onload = function() {
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;
  }

  update_total_correct();
}

</script><script>
$( document ).ready(function() {
  var cite = ' ';
  var psyteachr = ' <a href="https://psyteachr.github.io/"><img src="images/logos/psyteachr_logo.png" style="height: 31px; color: white;" alt="psyTeachR: Reproducible Research" /></a>';
  var license = ' <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/" target="blank"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png"></a>';

  $("footer div.row div:eq(1) p").html(
    psyteachr + license + cite
  );
});
</script><div class="chapter-nav">
<div class="prev"><a href="multiple-regression.html"><span class="header-section-number">3</span> Multiple regression</a></div>
<div class="next"><a href="introducing-linear-mixed-effects-models.html"><span class="header-section-number">5</span> Introducing linear mixed-effects models</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#interactions"><span class="header-section-number">4</span> Interactions</a></li>
<li><a class="nav-link" href="#cont-by-cat"><span class="header-section-number">4.1</span> Continuous-by-Categorical Interactions</a></li>
<li>
<a class="nav-link" href="#categorical-by-categorical-interactions"><span class="header-section-number">4.2</span> Categorical-by-Categorical Interactions</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#effects-of-cognitive-therapy-and-drug-therapy-on-mood"><span class="header-section-number">4.2.1</span> Effects of cognitive therapy and drug therapy on mood</a></li>
<li><a class="nav-link" href="#effects-in-a-factorial-design"><span class="header-section-number">4.2.2</span> Effects in a factorial design</a></li>
<li><a class="nav-link" href="#higher-order-designs"><span class="header-section-number">4.2.3</span> Higher-order designs</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#the-glm-for-a-factorial-design"><span class="header-section-number">4.3</span> The GLM for a factorial design</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#estimation-equations"><span class="header-section-number">4.3.1</span> Estimation equations</a></li>
<li><a class="nav-link" href="#factorial-app"><span class="header-section-number">4.3.2</span> Factorial App</a></li>
</ul>
</li>
<li><a class="nav-link" href="#code-your-own-categorical-predictors-in-factorial-designs"><span class="header-section-number">4.4</span> Code your own categorical predictors in factorial designs</a></li>
<li>
<a class="nav-link" href="#coding-schemes-for-categorical-variables"><span class="header-section-number">4.5</span> Coding schemes for categorical variables</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#simple-versus-main-effects"><span class="header-section-number">4.5.1</span> Simple versus main effects</a></li>
<li><a class="nav-link" href="#the-key-coding-schemes"><span class="header-section-number">4.5.2</span> The key coding schemes</a></li>
<li><a class="nav-link" href="#what-about-factors-with-more-than-two-levels"><span class="header-section-number">4.5.3</span> What about factors with more than two levels?</a></li>
<li><a class="nav-link" href="#example-three-level-factor"><span class="header-section-number">4.5.4</span> Example: Three-level factor</a></li>
<li><a class="nav-link" href="#how-to-create-your-own-numeric-predictors"><span class="header-section-number">4.5.5</span> How to create your own numeric predictors</a></li>
<li><a class="nav-link" href="#conclusion"><span class="header-section-number">4.5.6</span> Conclusion</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/psyteachr/stat-models-v1/blob/master/04-interactions.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/psyteachr/stat-models-v1/edit/master/04-interactions.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Learning Statistical Models Through Simulation in R</strong>" was written by Dale J. Barr. It was last built on 2021-10-28.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
